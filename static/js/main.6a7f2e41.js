(()=>{"use strict";var e={3044:(e,t,o)=>{var n=o(2299),r=o(6665),a=o(530),l=o(3929),i=o(765),s=o(4420),d=o(6313),c=o(1385),u=o(6283),f=o(932),g=o(5648),m=o(1690),h=o(3668),x=o(7908),p=o(2550),y=o(3715),j=o(9685);const b=(0,x.initializeApp)({apiKey:"AIzaSyD7npo_-9KAwTJCxwRtzgceJt4_bostfss",authDomain:"donateit-80076.firebaseapp.com",projectId:"donateit-80076",storageBucket:"donateit-80076.firebasestorage.app",messagingSenderId:"916451582794",appId:"1:916451582794:web:efb23b8735dad5dd5217b3",measurementId:"G-D999GEXDBT"}),C=(0,p.getAuth)(b),T=(0,y.getFirestore)(b);(0,j.getStorage)(b);var S=o(7109),w=o(397);function z({navigation:e}){const[t,o]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[s,d]=(0,r.useState)(null),[h,x]=(0,r.useState)(!1),[p,j]=(0,r.useState)(null),[b,z]=(0,r.useState)({exists:!1,name:"Event Organizer",email:""}),I=async()=>{i(!0),j(null);try{const e=await S.default.get("http://localhost:5000/api/user/events",{timeout:1e4});if(!e.data)throw new Error("Empty response from server");const t=await Promise.all(e.data.map((async e=>{try{const t=!!e.organizer_id&&await v(e.organizer_id);return Object.assign({},e,{organizerId:e.organizer_id,organizerExists:t,organizerName:t&&(await(0,y.getDoc)((0,y.doc)(T,"users",e.organizer_id))).data().displayName||"Organizer"})}catch(t){return console.error("Error processing event:",t),Object.assign({},e,{organizerId:e.organizer_id,organizerExists:!1,organizerName:"Organizer",error:!0})}})));o(t)}catch(p){j(p.message||"Failed to load events")}finally{i(!1)}},v=async e=>{try{const t=(0,y.doc)(T,"users",e);return(await(0,y.getDoc)(t)).exists()}catch(p){return console.error("Organizer verification failed:",p),!1}},k=async()=>{x(!0);try{if(!s?.organizerId)throw new Error("This event has no organizer assigned");const t=C.currentUser;if(!t?.uid)throw new Error("Please sign in to chat");const o=`${s._id}_${t.uid}_${s.organizerId}`,n={name:"Event Organizer",email:"",photoURL:null};let r=n;try{const e=(0,y.doc)(T,"users",s.organizerId),t=await(0,y.getDoc)(e);if(t.exists()){const e=t.data();r={name:e.displayName||e.name||n.name,email:e.email||n.email,photoURL:e.photoURL||n.photoURL}}}catch(p){console.log("Using default organizer info due to error:",p)}await(0,y.setDoc)((0,y.doc)(T,"chats",o),{id:o,participants:[t.uid,s.organizerId],participantInfo:{[t.uid]:{name:t.displayName||"User",email:t.email||"",photoURL:t.photoURL||null},[s.organizerId]:r},eventId:s._id,eventName:s.name,createdAt:(0,y.serverTimestamp)(),lastMessage:"Chat started",lastMessageAt:(0,y.serverTimestamp)()},{merge:!0}),e.navigate("Chats",{screen:"ChatList",params:{refresh:Date.now()}}),setTimeout((()=>{e.navigate("Chats",{screen:"ChatScreen",params:{chatId:o,otherUserId:s.organizerId,otherUserName:r.name,eventName:s.name}})}),300)}catch(p){console.error("Chat creation failed:",p),m.default.alert("Error",p.message,[{text:"OK"}])}finally{x(!1)}};return(0,r.useEffect)((()=>{const t=e.addListener("focus",I);return I(),t}),[e]),n?(0,w.jsxs)(l.default,{style:B.loadingContainer,children:[(0,w.jsx)(a.default,{size:"large",color:"#000"}),(0,w.jsx)(u.default,{style:B.loadingText,children:"Loading events..."})]}):p?(0,w.jsxs)(l.default,{style:B.errorContainer,children:[(0,w.jsx)(c.default,{name:"warning",size:50,color:"#000"}),(0,w.jsx)(u.default,{style:B.errorText,children:"Error loading events"}),(0,w.jsx)(u.default,{style:B.errorSubText,children:p}),(0,w.jsx)(g.default,{style:B.retryButton,onPress:I,children:(0,w.jsx)(u.default,{style:B.retryButtonText,children:"Try Again"})})]}):s?(0,w.jsxs)(l.default,{style:B.detailContainer,children:[(0,w.jsxs)(g.default,{onPress:()=>d(null),style:B.backButton,children:[(0,w.jsx)(c.default,{name:"arrow-back",size:24,color:"#000"}),(0,w.jsx)(u.default,{style:B.backButtonText,children:"All Events"})]}),(0,w.jsx)(l.default,{style:B.eventImagePlaceholder}),(0,w.jsx)(u.default,{style:B.detailTitle,children:s.name}),(0,w.jsxs)(u.default,{style:B.detailOrganizer,children:["Organized by ",b.name]}),(0,w.jsxs)(l.default,{style:B.section,children:[(0,w.jsx)(u.default,{style:B.sectionTitle,children:"About this event"}),(0,w.jsx)(u.default,{style:B.detailDescription,children:s.description})]}),(0,w.jsxs)(l.default,{style:B.section,children:[(0,w.jsx)(u.default,{style:B.sectionTitle,children:"Details"}),(0,w.jsxs)(l.default,{style:B.detailRow,children:[(0,w.jsx)(c.default,{name:"calendar",size:20,color:"#000",style:B.detailIcon}),(0,w.jsxs)(l.default,{children:[(0,w.jsx)(u.default,{style:B.detailLabel,children:"Date"}),(0,w.jsx)(u.default,{style:B.detailValue,children:new Date(s.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]})]}),(0,w.jsxs)(l.default,{style:B.detailRow,children:[(0,w.jsx)(c.default,{name:"location",size:20,color:"#000",style:B.detailIcon}),(0,w.jsxs)(l.default,{children:[(0,w.jsx)(u.default,{style:B.detailLabel,children:"Location"}),(0,w.jsx)(u.default,{style:B.detailValue,children:s.location.address})]})]})]}),(0,w.jsx)(l.default,{style:B.footer,children:h?(0,w.jsx)(a.default,{size:"small",color:"#000"}):(0,w.jsxs)(g.default,{style:B.chatButton,onPress:k,children:[(0,w.jsx)(c.default,{name:"chatbubble-ellipses",size:20,color:"#fff"}),(0,w.jsx)(u.default,{style:B.chatButtonText,children:"Message Organizer"})]})})]}):(0,w.jsxs)(l.default,{style:B.container,children:[(0,w.jsx)(l.default,{style:B.headerContainer,children:(0,w.jsx)(u.default,{style:B.header,children:"Upcoming Events"})}),0===t.length?(0,w.jsxs)(l.default,{style:B.emptyContainer,children:[(0,w.jsx)(c.default,{name:"calendar",size:50,color:"#aaa"}),(0,w.jsx)(u.default,{style:B.emptyText,children:"No events available"}),(0,w.jsx)(u.default,{style:B.emptySubText,children:"Check back later for new events"}),(0,w.jsx)(g.default,{style:B.refreshButton,onPress:I,children:(0,w.jsx)(u.default,{style:B.refreshButtonText,children:"Refresh"})})]}):(0,w.jsx)(f.default,{data:t,keyExtractor:e=>e._id,renderItem:({item:e})=>(0,w.jsxs)(g.default,{onPress:()=>(async e=>{if(d(e),e.organizerId)try{const t=(0,y.doc)(T,"users",e.organizerId),o=await(0,y.getDoc)(t);if(o.exists()){const e=o.data();z({exists:!0,name:e.displayName||"Event Organizer",email:e.email||""})}else z({exists:!1,name:"Event Organizer",email:""})}catch(p){console.error("Organizer fetch error:",p),z({exists:!1,name:"Event Organizer",email:""})}})(e),style:[B.eventCard,s?._id===e._id&&B.selectedEventCard],children:[(0,w.jsxs)(l.default,{style:B.eventHeaderContainer,children:[(0,w.jsx)(u.default,{style:B.eventTitle,children:e.name}),(0,w.jsx)(c.default,{name:"chevron-forward",size:20,color:"#555"})]}),(0,w.jsxs)(u.default,{style:B.eventBy,children:["Hosted by ",e.organizerName]}),(0,w.jsx)(u.default,{style:B.eventDescription,numberOfLines:2,children:e.description}),(0,w.jsxs)(l.default,{style:B.eventDetails,children:[(0,w.jsxs)(l.default,{style:B.detailItem,children:[(0,w.jsx)(c.default,{name:"calendar",size:14,color:"#555"}),(0,w.jsx)(u.default,{style:B.detailText,children:new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),(0,w.jsxs)(l.default,{style:B.detailItem,children:[(0,w.jsx)(c.default,{name:"location",size:14,color:"#555"}),(0,w.jsx)(u.default,{style:B.detailText,numberOfLines:1,children:e.location.address})]})]})]}),contentContainerStyle:B.listContent,showsVerticalScrollIndicator:!1})]})}const B=h.default.create({container:{flex:1,padding:16,backgroundColor:"#fff"},headerContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:24},header:{fontSize:28,fontWeight:"700",color:"#000"},eventCard:{backgroundColor:"#fff",borderRadius:12,padding:16,marginBottom:16,borderWidth:1,borderColor:"#eee",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.05,shadowRadius:2,elevation:1},selectedEventCard:{borderColor:"#000"},eventHeaderContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},eventTitle:{fontSize:18,fontWeight:"600",color:"#000",flex:1},eventBy:{color:"#555",fontSize:14,marginBottom:8},eventDescription:{color:"#333",fontSize:14,marginBottom:12,lineHeight:20},eventDetails:{flexDirection:"row",justifyContent:"space-between"},detailItem:{flexDirection:"row",alignItems:"center",flex:1},detailText:{color:"#555",fontSize:13,marginLeft:6},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#fff"},loadingText:{marginTop:16,color:"#555"},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24,backgroundColor:"#fff"},errorText:{fontSize:18,fontWeight:"600",color:"#000",marginTop:16},errorSubText:{fontSize:14,color:"#555",marginTop:8,textAlign:"center",marginBottom:24},retryButton:{backgroundColor:"#000",paddingHorizontal:24,paddingVertical:12,borderRadius:8},retryButtonText:{color:"#fff",fontWeight:"600"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24},emptyText:{fontSize:18,fontWeight:"600",color:"#000",marginTop:16},emptySubText:{fontSize:14,color:"#555",marginTop:8,marginBottom:24},refreshButton:{borderWidth:1,borderColor:"#000",paddingHorizontal:24,paddingVertical:12,borderRadius:8},refreshButtonText:{color:"#000",fontWeight:"600"},detailContainer:{flex:1,backgroundColor:"#fff"},backButton:{flexDirection:"row",alignItems:"center",padding:16},backButtonText:{fontSize:16,color:"#000",marginLeft:8},eventImagePlaceholder:{height:200,backgroundColor:"#eee",width:"100%"},detailTitle:{fontSize:24,fontWeight:"700",color:"#000",marginHorizontal:16,marginTop:16},detailOrganizer:{fontSize:16,color:"#555",marginHorizontal:16,marginBottom:24},section:{marginHorizontal:16,marginBottom:24},sectionTitle:{fontSize:18,fontWeight:"600",color:"#000",marginBottom:12},detailDescription:{fontSize:15,color:"#333",lineHeight:22},detailRow:{flexDirection:"row",marginBottom:16},detailIcon:{marginRight:16},detailLabel:{fontSize:14,color:"#555",marginBottom:2},detailValue:{fontSize:16,color:"#000"},footer:{padding:16,borderTopWidth:1,borderTopColor:"#eee"},chatButton:{backgroundColor:"#000",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:16,borderRadius:8},chatButtonText:{color:"#fff",fontWeight:"600",marginLeft:8},listContent:{paddingBottom:16}});var I=o(2772),v=o(484),k=o(4701);function E({navigation:e}){const[t,o]=(0,r.useState)(null),[n,i]=(0,r.useState)([]),[s,d]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),[j,b]=(0,r.useState)(!0),z=async()=>{try{const t="VlNgmUErG7QjqCC5hhLkPoyDb0P2";if(!C.currentUser)return void m.default.alert("Error","You must be logged in to contact admin");const o=await B(t,"Admin",s?s._id:null,s?`Donation: ${s.category||"Untitled"}`:"General Inquiry");(t=>{e.navigate("Chats"),setTimeout((()=>{e.navigate("Chats",{screen:"ChatScreen",params:t})}),100)})({chatId:o.chatId,otherUserId:t,otherUserName:"Admin",eventName:o.eventName})}catch(h){console.error("Error contacting admin:",h),m.default.alert("Error","Failed to open chat with admin. Please try again later.")}},B=async(e,t,o,n)=>{try{const r=C.currentUser;if(!r)throw new Error("User not authenticated");const a=await(async e=>{try{const t=C.currentUser;if(!t)return null;const o=(0,y.collection)(T,"chats"),n=[t.uid,e].sort().join("_"),r=await(0,y.getDocs)((0,y.query)(o,(0,y.where)("chatKey","==",n)));if(!r.empty){const e=r.docs[0];return Object.assign({id:e.id},e.data())}return null}catch(h){return console.error("Error checking for existing admin chat:",h),null}})(e);if(a)return{chatId:a.id,otherUserId:e,otherUserName:a.participantInfo?.[e]?.name||t,eventName:n||a.eventName||"Admin Chat"};const l=[r.uid,e].sort().join("_"),i={participants:[r.uid,e],participantInfo:{[r.uid]:{name:r.displayName||"User",photoURL:r.photoURL||null},[e]:{name:t,photoURL:null}},donationId:o,eventName:n||"Admin Chat",lastMessage:"",lastMessageAt:(0,y.serverTimestamp)(),createdAt:(0,y.serverTimestamp)(),chatKey:l},s=(0,y.doc)((0,y.collection)(T,"chats"));await(0,y.setDoc)(s,i);const d=(0,y.collection)(T,"chats",s.id,"messages");return await(0,y.addDoc)(d,{text:o?`Hello! I need help with my donation (${n}).`:"Hello! I need some assistance.",senderId:r.uid,senderName:r.displayName||"User",createdAt:(0,y.serverTimestamp)()}),await(0,y.setDoc)(s,{lastMessage:o?`Hello! I need help with my donation (${n}).`:"Hello! I need some assistance.",lastMessageAt:(0,y.serverTimestamp)()},{merge:!0}),{chatId:s.id,otherUserId:e,otherUserName:t,eventName:n||"Admin Chat"}}catch(h){throw console.error("Error in getOrCreateAdminChat:",h),h}};if((0,r.useEffect)((()=>{(async()=>{try{b(!0);const e=C.currentUser,t=await e.getIdToken(),n=await S.default.get("http://localhost:5000/api/user/user-details",{headers:{Authorization:`Bearer ${t}`}});o(n.data);const r=(await S.default.get("http://localhost:5000/api/user/donations",{headers:{Authorization:`Bearer ${t}`}})).data.filter((t=>t.uid===e.uid));i(r)}catch(e){const t=e.response?.data?.message||e.message;m.default.alert("Error",t),x(t)}finally{b(!1)}})()}),[]),j)return(0,w.jsxs)(l.default,{style:D.loadingContainer,children:[(0,w.jsx)(a.default,{size:"large",color:"#000"}),(0,w.jsx)(u.default,{style:D.loadingText,children:"Loading profile..."})]});if(h)return(0,w.jsxs)(l.default,{style:D.errorContainer,children:[(0,w.jsx)(c.default,{name:"warning",size:40,color:"#000"}),(0,w.jsx)(u.default,{style:D.errorText,children:h}),(0,w.jsx)(g.default,{style:D.retryButton,onPress:()=>{x(null),b(!0),fetchProfileAndDonations()},children:(0,w.jsx)(u.default,{style:D.retryButtonText,children:"Try Again"})})]});return s?(0,w.jsxs)(k.default,{style:D.detailContainer,children:[(0,w.jsxs)(g.default,{onPress:()=>d(null),style:D.backButton,children:[(0,w.jsx)(c.default,{name:"arrow-back",size:24,color:"#000"}),(0,w.jsx)(u.default,{style:D.backButtonText,children:"Back to Donations"})]}),(0,w.jsx)(I.default,{showsVerticalScrollIndicator:!1,contentContainerStyle:D.detailScrollContent,children:(0,w.jsxs)(l.default,{style:D.detailContent,children:[(0,w.jsx)(u.default,{style:D.detailTitle,children:s.category||"Donation"}),(0,w.jsxs)(l.default,{style:D.detailSection,children:[(0,w.jsx)(u.default,{style:D.sectionLabel,children:"DESCRIPTION"}),(0,w.jsx)(u.default,{style:D.sectionText,children:s.description||"No description provided"})]}),(0,w.jsxs)(l.default,{style:D.detailSection,children:[(0,w.jsx)(u.default,{style:D.sectionLabel,children:"AVAILABILITY"}),(0,w.jsxs)(l.default,{style:D.infoRow,children:[(0,w.jsx)(c.default,{name:"calendar-outline",size:16,color:"#666",style:D.infoIcon}),(0,w.jsx)(u.default,{style:D.sectionText,children:s.availability||"Not specified"})]})]}),(0,w.jsxs)(l.default,{style:D.detailSection,children:[(0,w.jsx)(u.default,{style:D.sectionLabel,children:"PICKUP TIME"}),(0,w.jsxs)(l.default,{style:D.infoRow,children:[(0,w.jsx)(c.default,{name:"calendar-outline",size:16,color:"#666",style:D.infoIcon}),(0,w.jsx)(u.default,{style:D.sectionText,children:s.dateTime||"Not specified"})]})]}),(0,w.jsxs)(l.default,{style:D.detailSection,children:[(0,w.jsx)(u.default,{style:D.sectionLabel,children:"ASSIGNEE"}),(0,w.jsxs)(l.default,{style:D.infoRow,children:[(0,w.jsx)(c.default,{name:"person-outline",size:16,color:"#666",style:D.infoIcon}),(0,w.jsx)(u.default,{style:D.sectionText,children:s.assignee||"Not specified"})]})]}),s.address?.address&&(0,w.jsxs)(l.default,{style:D.detailSection,children:[(0,w.jsx)(u.default,{style:D.sectionLabel,children:"LOCATION"}),(0,w.jsxs)(l.default,{style:D.infoRow,children:[(0,w.jsx)(c.default,{name:"location-outline",size:16,color:"#666",style:D.infoIcon}),(0,w.jsx)(u.default,{style:D.sectionText,children:s.address.address})]})]}),s.images?.length>0&&(0,w.jsxs)(l.default,{style:D.detailSection,children:[(0,w.jsx)(u.default,{style:D.sectionLabel,children:"PHOTOS"}),(0,w.jsx)(I.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:D.photosContainer,children:s.images.map(((e,t)=>(0,w.jsx)(v.default,{source:{uri:e},style:D.donationImage},t)))})]}),(0,w.jsxs)(g.default,{style:D.contactButton,onPress:z,children:[(0,w.jsx)(c.default,{name:"chatbubble-outline",size:20,color:"#fff"}),(0,w.jsx)(u.default,{style:D.contactButtonText,children:"Contact Admin About This Donation"})]})]})})]}):(0,w.jsxs)(k.default,{style:D.container,children:[(0,w.jsxs)(I.default,{showsVerticalScrollIndicator:!1,contentContainerStyle:D.scrollContent,children:[(0,w.jsxs)(l.default,{style:D.profileHeader,children:[(0,w.jsx)(l.default,{style:D.profileImageContainer,children:(0,w.jsx)(c.default,{name:"person-circle-outline",size:80,color:"#000"})}),(0,w.jsx)(u.default,{style:D.profileName,children:t?.name||"User"}),(0,w.jsx)(u.default,{style:D.profileEmail,children:t?.email})]}),(0,w.jsxs)(l.default,{style:D.section,children:[(0,w.jsxs)(l.default,{style:D.sectionHeader,children:[(0,w.jsx)(c.default,{name:"list-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:D.sectionTitle,children:"Your Donations"})]}),0===n.length?(0,w.jsxs)(l.default,{style:D.emptyState,children:[(0,w.jsx)(c.default,{name:"archive-outline",size:40,color:"#999"}),(0,w.jsx)(u.default,{style:D.emptyText,children:"No donations posted yet"})]}):(0,w.jsx)(f.default,{data:n,keyExtractor:e=>e._id,renderItem:({item:e})=>(0,w.jsxs)(g.default,{onPress:()=>d(e),style:D.donationCard,children:[(0,w.jsxs)(l.default,{style:D.donationHeader,children:[(0,w.jsx)(c.default,{name:"gift",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:D.donationTitle,children:e.category||"Untitled"})]}),e.donationDescription&&(0,w.jsx)(u.default,{style:D.donationDescription,numberOfLines:2,children:e.donationDescription}),e.availability&&(0,w.jsxs)(l.default,{style:D.donationDateContainer,children:[(0,w.jsx)(c.default,{name:"time",size:14,color:"#666"}),(0,w.jsx)(u.default,{style:D.donationDate,children:e.availability})]})]}),contentContainerStyle:D.listContent,scrollEnabled:!1})]})]}),(0,w.jsxs)(l.default,{style:D.footer,children:[(0,w.jsxs)(g.default,{style:D.actionButton,onPress:async()=>{try{const e=C.currentUser;if(!e)return void m.default.alert("Error","User not authenticated");await(0,p.sendPasswordResetEmail)(C,e.email),m.default.alert("Success","Password reset email sent. Please check your inbox.")}catch(h){console.error("Error sending password reset email:",h),m.default.alert("Error","Failed to send password reset email")}},children:[(0,w.jsx)(c.default,{name:"key-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:D.actionButtonText,children:"Reset Password"}),(0,w.jsx)(c.default,{name:"chevron-forward",size:20,color:"#666"})]}),(0,w.jsxs)(g.default,{style:D.actionButton,onPress:z,children:[(0,w.jsx)(c.default,{name:"headset-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:D.actionButtonText,children:"Contact Admin"}),(0,w.jsx)(c.default,{name:"chevron-forward",size:20,color:"#666"})]}),(0,w.jsxs)(g.default,{style:D.logoutButton,onPress:async()=>{await C.signOut()},children:[(0,w.jsx)(c.default,{name:"log-out-outline",size:20,color:"#fff"}),(0,w.jsx)(u.default,{style:D.logoutText,children:"Log Out"})]})]})]})}const D=h.default.create({container:{flex:1,backgroundColor:"#fff"},scrollContent:{padding:16,paddingBottom:100},detailScrollContent:{padding:16},actionButton:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,backgroundColor:"#fff",borderRadius:8,borderWidth:1,borderColor:"#eee",marginBottom:16},actionButtonText:{flex:1,fontSize:16,color:"#000",marginLeft:12},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#fff"},loadingText:{marginTop:16,color:"#000",fontSize:16},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24,backgroundColor:"#fff"},errorText:{fontSize:16,color:"#000",marginTop:16,textAlign:"center",marginBottom:24},retryButton:{backgroundColor:"#000",paddingHorizontal:24,paddingVertical:12,borderRadius:8,flexDirection:"row",alignItems:"center"},retryButtonText:{color:"#fff",fontWeight:"600",marginLeft:8},profileHeader:{alignItems:"center",marginBottom:24,padding:20,backgroundColor:"#fff",borderRadius:12,borderWidth:1,borderColor:"#eee"},profileImageContainer:{backgroundColor:"#f5f5f5",borderRadius:40,padding:8},profileName:{fontSize:22,fontWeight:"600",marginTop:12,color:"#000",textAlign:"center"},profileEmail:{fontSize:16,color:"#666",marginTop:4,textAlign:"center"},section:{marginBottom:16,backgroundColor:"#fff",borderRadius:12,padding:20,borderWidth:1,borderColor:"#eee"},sectionHeader:{flexDirection:"row",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:"#000",marginLeft:8},donationCard:{backgroundColor:"#fff",borderRadius:8,padding:16,marginBottom:12,borderWidth:1,borderColor:"#eee"},donationHeader:{flexDirection:"row",alignItems:"center",marginBottom:8},donationTitle:{fontSize:16,fontWeight:"600",color:"#000",marginLeft:8},donationDescription:{fontSize:14,color:"#333",marginBottom:8,lineHeight:20},donationDateContainer:{flexDirection:"row",alignItems:"center",marginTop:4},donationDate:{fontSize:12,color:"#666",marginLeft:4},listContent:{paddingBottom:8},emptyState:{alignItems:"center",padding:24},emptyText:{fontSize:16,color:"#999",marginTop:16},footer:{position:"absolute",bottom:0,left:0,right:0,padding:16,backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#eee"},contactAdminButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,backgroundColor:"#000",borderRadius:8,marginBottom:12},contactAdminText:{fontSize:16,fontWeight:"500",color:"#fff",marginLeft:8},logoutButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,backgroundColor:"#333",borderRadius:8},logoutText:{fontSize:16,fontWeight:"500",color:"#fff",marginLeft:8},detailContainer:{flex:1,backgroundColor:"#fff"},detailContent:{paddingBottom:100},backButton:{flexDirection:"row",alignItems:"center",padding:16,paddingBottom:8},backButtonText:{fontSize:16,color:"#000",marginLeft:8,fontWeight:"500"},detailTitle:{fontSize:24,fontWeight:"700",color:"#000",marginBottom:24,marginTop:8,paddingHorizontal:16},detailSection:{marginBottom:24,backgroundColor:"#fff",borderRadius:8,padding:20,borderWidth:1,borderColor:"#eee",marginHorizontal:16},sectionLabel:{fontSize:13,fontWeight:"700",color:"#666",marginBottom:12,textTransform:"uppercase",letterSpacing:1},sectionText:{fontSize:16,color:"#000",lineHeight:24},infoRow:{flexDirection:"row",alignItems:"center",marginTop:8},infoIcon:{marginRight:8},photosContainer:{paddingVertical:8},donationImage:{width:150,height:150,borderRadius:8,marginRight:12,backgroundColor:"#f5f5f5"},contactButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,backgroundColor:"#000",borderRadius:8,marginTop:16,marginBottom:24,marginHorizontal:16},contactButtonText:{fontSize:16,fontWeight:"500",color:"#fff",marginLeft:8}});var R=o(6773),P=o(7366);o(8801),o(9050),o(5433);const L="AIzaSyDw26V3Tw0g6tXKWX5ruHx8nAl6eJrn7vI",W=h.default.create({container:{flex:1,backgroundColor:"#fff"},contentContainer:{padding:20,maxWidth:800,width:"100%",alignSelf:"center"},headerText:{fontSize:28,fontWeight:"700",marginBottom:30,textAlign:"center",color:"#000"},inputGroup:{marginBottom:20},label:{fontSize:16,fontWeight:"600",marginBottom:8,color:"#000"},pickerContainer:{borderWidth:1,borderColor:"#eee",borderRadius:8,overflow:"hidden"},picker:{height:50,backgroundColor:"#fff",color:"#000"},input:{height:50,borderWidth:1,borderColor:"#eee",marginBottom:5,paddingHorizontal:15,backgroundColor:"#fff",borderRadius:8,fontSize:16,color:"#000"},errorInput:{borderColor:"#ff0000"},errorText:{color:"red",fontSize:14,marginTop:5},uploadButton:{flexDirection:"row",alignItems:"center",padding:15,borderWidth:1,borderColor:"#eee",borderRadius:8,backgroundColor:"#fff"},uploadIcon:{marginRight:10},uploadButtonText:{fontSize:16,color:"#000",fontWeight:"500"},photoPreviewText:{fontSize:16,fontWeight:"600",marginBottom:10,color:"#000"},photoScroll:{flexDirection:"row",paddingVertical:5},photoItem:{marginRight:15,position:"relative"},photo:{width:100,height:100,borderRadius:8,borderWidth:1,borderColor:"#eee"},deleteButton:{position:"absolute",top:-8,right:-8,backgroundColor:"#000",borderRadius:12,width:24,height:24,justifyContent:"center",alignItems:"center"},submitContainer:{marginTop:20,marginBottom:30},submitButton:{backgroundColor:"#000",padding:16,borderRadius:8,alignItems:"center"},submitButtonText:{color:"#fff",fontSize:18,fontWeight:"600"},loadingContainer:{alignItems:"center",padding:16},loadingText:{marginTop:10,color:"#555"},requiredFieldsText:{textAlign:"center",color:"#666",fontSize:14},autocompleteWrapper:{zIndex:1},dropdown:{backgroundColor:"#fff",borderWidth:1,borderColor:"#eee",borderRadius:8,marginTop:5},placeDescription:{color:"#000",padding:10},placeItem:{padding:10,color:"#000"}}),A=()=>{const[e,t]=(0,r.useState)("groceries"),[o,n]=(0,r.useState)(""),[i,s]=(0,r.useState)([]),[d,f]=(0,r.useState)(""),[h,x]=(0,r.useState)(!1),[p,j]=(0,r.useState)({description:"",photos:"",pickupTime:""}),[b,T]=(0,r.useState)({address:"",lat:null,lng:null,placeId:null}),[z,B]=(0,r.useState)(!1),k=((0,r.useRef)(null),{meetingPoint:(0,r.useRef)(null)});(0,r.useEffect)((()=>{if(z)try{const e=document.getElementById("meeting-point-input");e&&!k.meetingPoint.current&&(k.meetingPoint.current=new window.google.maps.places.Autocomplete(e,{types:["geocode","establishment"],componentRestrictions:{country:"us"},fields:["formatted_address","geometry","place_id"]}),k.meetingPoint.current.addListener("place_changed",(()=>{const e=k.meetingPoint.current.getPlace();e.geometry&&E(null,{description:e.formatted_address,geometry:{location:e.geometry.location},place_id:e.place_id})})))}catch(e){console.error("Error initializing autocomplete:",e)}}),[z]),(0,r.useEffect)((()=>{{if(window.google&&window.google.maps)return void B(!0);const e="google-maps-script";if(document.getElementById(e))return void B(!0);const t=document.createElement("script");return t.id=e,t.src=`https://maps.googleapis.com/maps/api/js?key=${L}&libraries=places`,t.async=!0,t.defer=!0,t.onload=()=>{console.log("Google Maps script loaded successfully"),B(!0)},t.onerror=()=>{console.error("Failed to load Google Maps script"),m.default.alert("Error","Failed to load maps functionality")},document.head.appendChild(t),()=>{document.head.contains(t)&&document.head.removeChild(t)}}}),[]);const E=async(e,t=null)=>{let o,n,r,a;t&&(o=t.description,n=t.geometry.location.lat(),r=t.geometry.location.lng(),a=t.place_id,T({address:o,lat:n,lng:r,placeId:a}))};return(0,w.jsx)(I.default,{style:W.container,children:(0,w.jsxs)(l.default,{style:W.contentContainer,children:[(0,w.jsx)(u.default,{style:W.headerText,children:"Start your pickup Request"}),(0,w.jsxs)(l.default,{style:W.inputGroup,children:[(0,w.jsx)(u.default,{style:W.label,children:"Category *"}),(0,w.jsx)(l.default,{style:W.pickerContainer,children:(0,w.jsxs)(P.Picker,{selectedValue:e,onValueChange:t,style:W.picker,children:[(0,w.jsx)(P.Picker.Item,{label:"Groceries",value:"groceries"}),(0,w.jsx)(P.Picker.Item,{label:"Clothing",value:"clothing"}),(0,w.jsx)(P.Picker.Item,{label:"Furniture",value:"furniture"}),(0,w.jsx)(P.Picker.Item,{label:"Others",value:"others"})]})})]}),(0,w.jsxs)(l.default,{style:W.inputGroup,children:[(0,w.jsx)(u.default,{style:W.label,children:"Description *"}),(0,w.jsx)(R.default,{value:o,onChangeText:e=>{n(e),e.trim()&&j((e=>Object.assign({},e,{description:""})))},placeholder:"Describe the items you're donating",multiline:!0,style:[W.input,p.description?W.errorInput:{}],placeholderTextColor:"#888"}),p.description?(0,w.jsx)(u.default,{style:W.errorText,children:p.description}):null]}),(0,w.jsxs)(l.default,{style:W.inputGroup,children:[(D="Pickup Address",A="meeting-point",N=b.address,O=e=>T((t=>Object.assign({},t,{address:e}))),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.default,{style:W.label,children:D}),(0,w.jsx)(R.default,{id:`${A}-input`,style:W.input,placeholder:`Enter ${D.toLowerCase()}`,value:N,onChangeText:O,placeholderTextColor:"#888"})]})),p.address?(0,w.jsx)(u.default,{style:W.errorText,children:p.address}):null]}),(0,w.jsxs)(l.default,{style:W.inputGroup,children:[(0,w.jsx)(u.default,{style:W.label,children:"Available Time & Date *"}),(0,w.jsx)(R.default,{value:d,onChangeText:e=>{f(e),e.trim()&&j((e=>Object.assign({},e,{pickupTime:""})))},placeholder:"Enter available pickup time and date",style:[W.input,p.pickupTime?W.errorInput:{}],placeholderTextColor:"#888"}),p.pickupTime?(0,w.jsx)(u.default,{style:W.errorText,children:p.pickupTime}):null]}),(0,w.jsxs)(l.default,{style:W.inputGroup,children:[(0,w.jsxs)(g.default,{onPress:()=>document.getElementById("fileInput").click(),style:W.uploadButton,children:[(0,w.jsx)(c.default,{name:"images",size:20,color:"#000",style:W.uploadIcon}),(0,w.jsx)(u.default,{style:W.uploadButtonText,children:"Upload Donation Photos (Max 5)"})]}),p.photos?(0,w.jsx)(u.default,{style:W.errorText,children:p.photos}):null,(0,w.jsx)("input",{type:"file",id:"fileInput",multiple:!0,accept:"image/*",onChange:async e=>{const t=e.target.files;if(t.length>5)return void j((e=>Object.assign({},e,{photos:"Maximum 5 photos allowed"})));const o=Array.from(t).map((e=>URL.createObjectURL(e)));s(o),j((e=>Object.assign({},e,{photos:""})))},style:{display:"none"}})]}),i.length>0&&(0,w.jsxs)(l.default,{style:W.inputGroup,children:[(0,w.jsx)(u.default,{style:W.photoPreviewText,children:"Selected Photos:"}),(0,w.jsx)(I.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:W.photoScroll,children:i.map(((e,t)=>(0,w.jsxs)(l.default,{style:W.photoItem,children:[(0,w.jsx)(v.default,{source:{uri:e},style:W.photo}),(0,w.jsx)(g.default,{onPress:()=>{const e=[...i];e.splice(t,1),s(e)},style:W.deleteButton,children:(0,w.jsx)(c.default,{name:"close",size:16,color:"#fff"})})]},t)))})]}),(0,w.jsx)(l.default,{style:W.submitContainer,children:h?(0,w.jsxs)(l.default,{style:W.loadingContainer,children:[(0,w.jsx)(a.default,{size:"large",color:"#000"}),(0,w.jsx)(u.default,{style:W.loadingText,children:"Submitting donation..."})]}):(0,w.jsx)(g.default,{onPress:async()=>{if(!(()=>{let e=!0;const t={description:"",photos:"",pickupTime:""};return o.trim()||(t.description="Description is required",e=!1),b.address.trim()||(t.address="Address is required",e=!1),d.trim()||(t.pickupTime="Available time and date is required",e=!1),j(t),e})())return;const r=C.currentUser;if(r){x(!0);try{const a=await r.getIdToken(),l=i.map((e=>(async e=>{let t;{const o=await fetch(e);t=await o.blob()}const o=new FormData;o.append("file",t),o.append("upload_preset","donations_preset"),o.append("cloud_name","do0u4ae7b");try{const e=await fetch("https://api.cloudinary.com/v1_1/do0u4ae7b/image/upload",{method:"POST",body:o}),t=await e.json();if(!e.ok)throw new Error(t.message||"Upload failed");return t.secure_url}catch(n){throw console.error("Upload error:",n),n}})(e).catch((e=>(console.error(`Failed to upload image: ${e}`),null))))),c=(await Promise.all(l)).filter((e=>null!==e)),u={token:a,donationCategory:e,donationDescription:o,donorAddress:{address:b.address,coordinates:new y.GeoPoint(b.lat,b.lng),placeId:b.placeId},pickupTime:d,donationPhotos:c};201===(await S.default.post("http://localhost:5000/api/user/donations",u)).status&&(m.default.alert("Success","Donation added successfully!"),t("groceries"),n(""),f(""),s([]),T({address:"",lat:null,lng:null,placeId:null}))}catch(a){console.error("Error submitting donation:",a);const e=a.response?.data?.message||"Failed to submit donation. Please check your connection and try again.";m.default.alert("Submission Error",e)}finally{x(!1)}}else m.default.alert("Authentication Error","You must be logged in to submit a donation.")},style:W.submitButton,children:(0,w.jsx)(u.default,{style:W.submitButtonText,children:"Add Donation"})})}),(0,w.jsx)(u.default,{style:W.requiredFieldsText,children:"* Required fields"})]})});var D,A,N,O};var N=o(9632),O=o(8297);function U(){const[e,t]=(0,r.useState)([]),[o,n]=(0,r.useState)(!0),[i,s]=(0,r.useState)(null),[d,c]=(0,r.useState)(null),[f,m]=(0,r.useState)(""),[h,x]=(0,r.useState)([]),[p,y]=(0,r.useState)(!1),[j,b]=(0,r.useState)(13),C=(0,r.useRef)(null),T=(0,r.useRef)(null),z=(0,r.useRef)(null),B=(0,r.useRef)(null);(0,r.useEffect)((()=>{window.google&&(z.current=new window.google.maps.places.AutocompleteService,B.current=new window.google.maps.places.PlacesService(document.createElement("div")))}),[]),(0,r.useEffect)((()=>{(async()=>{try{let{status:e}=await O.requestForegroundPermissionsAsync();if("granted"!==e){s("Permission to access location was denied");const e={latitude:37.7749,longitude:-122.4194};return c(e),void v(e.latitude,e.longitude)}const t=await O.getCurrentPositionAsync({}),o={latitude:t.coords.latitude,longitude:t.coords.longitude};c(o),v(o.latitude,o.longitude)}catch(e){console.error("Error getting location:",e),s("Failed to get your location");const t={latitude:37.7749,longitude:-122.4194};c(t),v(t.latitude,t.longitude)}})()}),[]);const v=async(e,o)=>{n(!0),s(null);try{const n=(await S.default.get(`http://localhost:5000/api/user/donation-boxes?lat=${e}&lng=${o}&radius=5&limit=10`)).data;if(console.log(`Fetched ${n.length} nearby boxes`),0===n.length){console.log("No boxes found nearby, trying with a larger radius");const t=await S.default.get(`http://localhost:5000/api/user/donation-boxes?lat=${e}&lng=${o}&radius=20&limit=10`);n.push(...t.data)}const r=n.filter((e=>e.coordinates&&"number"===typeof e.coordinates.latitude&&"number"===typeof e.coordinates.longitude)).map((t=>{const n=k(e,o,t.coordinates.latitude,t.coordinates.longitude);return Object.assign({},t,{distance:n.toFixed(1)+" miles away",location:{coordinates:[t.coordinates.longitude,t.coordinates.latitude]}})})).sort(((e,t)=>parseFloat(e.distance)-parseFloat(t.distance))).slice(0,10);t(r),window.google?.maps&&E(r)}catch(r){console.error("API Error:",r),s("Couldn't connect to server. Using sample data.")}finally{n(!1)}},k=(e,t,o,n)=>{const r=(o-e)*Math.PI/180,a=(n-t)*Math.PI/180,l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(o*Math.PI/180)*Math.sin(a/2)*Math.sin(a/2);return 3958.8*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},E=e=>{if(!C.current||!window.google?.maps||!d)return;const t=new window.google.maps.Map(C.current,{center:{lat:d.latitude,lng:d.longitude},zoom:j,scrollwheel:!0,gestureHandling:"cooperative",zoomControl:!1,mapTypeControl:!0,streetViewControl:!1,fullscreenControl:!0});T.current=t,new window.google.maps.Marker({position:{lat:d.latitude,lng:d.longitude},map:t,title:"Your Location",icon:{url:"https://maps.google.com/mapfiles/ms/icons/blue-dot.png"}}),e.forEach((e=>{const o=new window.google.maps.Marker({position:{lat:e.location.coordinates[1],lng:e.location.coordinates[0]},map:t,title:e.name}),n=new window.google.maps.InfoWindow({content:`\n          <div>\n            <h3>${e.name}</h3>\n            <p>${e.address}</p>\n            <p>${e.distance}</p>\n          </div>\n        `});o.addListener("click",(()=>{n.open(t,o)}))}))};return(0,r.useEffect)((()=>{if(!window.google){const t=document.createElement("script");return t.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDSahTexUybVADs-MwPT4MNnWai_-kTr1I&libraries=places",t.async=!0,t.defer=!0,t.onload=()=>{z.current=new window.google.maps.places.AutocompleteService,B.current=new window.google.maps.places.PlacesService(document.createElement("div")),d&&e.length>0&&E(e)},document.head.appendChild(t),()=>{document.head.removeChild(t)}}}),[d,e]),o&&!e.length?(0,w.jsxs)(l.default,{style:[H.container,H.centered],children:[(0,w.jsx)(a.default,{size:"large",color:"#007AFF"}),(0,w.jsx)(u.default,{style:H.loadingText,children:"Finding donation boxes near you..."})]}):(0,w.jsx)(I.default,{style:H.mainScrollView,contentContainerStyle:H.mainScrollViewContent,showsVerticalScrollIndicator:!0,persistentScrollbar:!0,children:(0,w.jsxs)(l.default,{style:H.container,children:[(0,w.jsx)(u.default,{style:H.header,children:"DonateIt"}),(0,w.jsx)(u.default,{style:H.subheader,children:"Donation boxes near you"}),(0,w.jsxs)(l.default,{style:H.searchContainer,children:[(0,w.jsx)(R.default,{style:H.searchInput,placeholder:"Search for a location...",value:f,onChangeText:e=>{m(e),e.length>2&&z.current?z.current.getPlacePredictions({input:e,types:["geocode"]},((e,t)=>{"OK"===t?(x(e),y(!0)):y(!1)})):y(!1)}}),p&&(0,w.jsx)(l.default,{style:H.searchResultsContainer,children:(0,w.jsx)(I.default,{style:H.searchResultsScroll,keyboardShouldPersistTaps:"handled",nestedScrollEnabled:!0,children:h.map((e=>(0,w.jsx)(g.default,{style:H.searchResultItem,onPress:()=>{return m((t=e).description),y(!1),void B.current.getDetails({placeId:t.place_id},((e,t)=>{if("OK"===t&&e.geometry&&e.geometry.location){const t={latitude:e.geometry.location.lat(),longitude:e.geometry.location.lng()};c(t),v(t.latitude,t.longitude),T.current&&T.current.setCenter({lat:t.latitude,lng:t.longitude})}}));var t},children:(0,w.jsx)(u.default,{children:e.description})},e.place_id)))})})]}),(0,w.jsxs)(l.default,{style:H.mapContainer,children:[(0,w.jsxs)(l.default,{style:H.mapHeaderContainer,children:[(0,w.jsx)(u.default,{style:H.mapLabel,children:"Donation Boxes Map"}),(0,w.jsxs)(l.default,{style:H.mapControlsContainer,children:[(0,w.jsx)(g.default,{style:H.mapControlButton,onPress:()=>{if(T.current){const e=T.current.getZoom();T.current.setZoom(e+1),b(e+1)}},children:(0,w.jsx)(u.default,{style:H.mapControlText,children:"+"})}),(0,w.jsx)(g.default,{style:H.mapControlButton,onPress:()=>{if(T.current){const e=T.current.getZoom();e>1&&(T.current.setZoom(e-1),b(e-1))}},children:(0,w.jsx)(u.default,{style:H.mapControlText,children:"-"})})]})]}),i?(0,w.jsx)(u.default,{style:H.errorText,children:i}):(0,w.jsx)("div",{ref:C,style:{width:"100%",height:300,borderRadius:8,overflow:"hidden"}}),(0,w.jsx)(u.default,{style:H.mapInstructions,children:"Use Ctrl + Scroll to zoom the map, or the +/- buttons above."})]}),d&&(0,w.jsxs)(l.default,{style:H.locationInfo,children:[(0,w.jsx)(u.default,{style:H.locationText,children:i?"Using default location":"Using your current location"}),(0,w.jsx)(g.default,{style:H.refreshButton,onPress:()=>{d&&v(d.latitude,d.longitude)},children:(0,w.jsx)(u.default,{style:H.refreshText,children:"Refresh"})})]}),(0,w.jsx)(u.default,{style:H.sectionHeader,children:"Nearby Donation Boxes "}),0!==e.length||o?(0,w.jsx)(l.default,{style:H.scrollContainer,children:(0,w.jsx)(I.default,{style:H.boxesContainer,contentContainerStyle:H.boxesContentContainer,showsVerticalScrollIndicator:!0,persistentScrollbar:!0,alwaysBounceVertical:!0,scrollEventThrottle:16,nestedScrollEnabled:!0,children:e.map((e=>(0,w.jsxs)(l.default,{style:H.boxCard,children:[(0,w.jsx)(u.default,{style:H.boxName,children:e.name}),(0,w.jsx)(u.default,{style:H.boxDistance,children:e.distance}),(0,w.jsx)(u.default,{style:H.boxAddress,children:e.address}),(0,w.jsx)(g.default,{style:H.directionsButton,onPress:()=>((e,t,o)=>{const n=`https://www.google.com/maps/dir/?api=1&destination=${e},${t}&destination_place_id=${o}`;N.default.openURL(n)})(e.location.coordinates[1],e.location.coordinates[0],e.name),children:(0,w.jsx)(u.default,{style:H.directionsText,children:"Directions"})}),(0,w.jsx)(l.default,{style:H.divider})]},e._id||Math.random().toString())))})}):(0,w.jsx)(u.default,{style:H.noBoxesText,children:"No donation boxes found nearby."})]})})}const H=h.default.create({mainScrollView:{flex:1,backgroundColor:"#fff"},mainScrollViewContent:{flexGrow:1},container:{flex:1,padding:20,backgroundColor:"#fff"},centered:{justifyContent:"center",alignItems:"center"},header:{fontSize:24,fontWeight:"bold",marginBottom:5,color:"#000"},subheader:{fontSize:16,color:"#666",marginBottom:20},searchContainer:{marginBottom:20,position:"relative",zIndex:10},searchInput:{height:40,borderColor:"#ccc",borderWidth:1,borderRadius:8,paddingHorizontal:10,backgroundColor:"#fff"},searchResultsContainer:{position:"absolute",top:40,left:0,right:0,backgroundColor:"#fff",borderColor:"#ccc",borderWidth:1,borderRadius:8,zIndex:1e3,maxHeight:200,overflow:"hidden"},searchResultsScroll:{maxHeight:200},searchResultItem:{padding:10,borderBottomColor:"#eee",borderBottomWidth:1},mapContainer:{marginBottom:20,borderRadius:8,overflow:"hidden",borderWidth:1,borderColor:"#eee"},mapHeaderContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:10,paddingTop:10,paddingBottom:5},mapLabel:{fontWeight:"bold",fontSize:16,color:"#000"},mapControlsContainer:{flexDirection:"row",alignItems:"center"},mapControlButton:{width:30,height:30,backgroundColor:"#f0f0f0",borderRadius:15,justifyContent:"center",alignItems:"center",marginLeft:8,borderWidth:1,borderColor:"#ddd"},mapControlText:{fontSize:18,fontWeight:"bold",color:"#333"},mapInstructions:{fontSize:12,color:"#666",fontStyle:"italic",textAlign:"center",paddingVertical:5},divider:{height:1,backgroundColor:"#eee",marginVertical:15},sectionHeader:{fontSize:18,fontWeight:"bold",marginBottom:15,color:"#000"},scrollContainer:{flex:1,height:350,borderWidth:1,borderColor:"#eee",borderRadius:8,overflow:"hidden"},boxesContainer:{flex:1,height:"100%"},boxesContentContainer:{paddingVertical:10,paddingHorizontal:5},boxCard:{marginBottom:15,padding:15,backgroundColor:"#f9f9f9",borderRadius:8},boxName:{fontWeight:"bold",fontSize:16,marginBottom:5,color:"#000"},boxDistance:{color:"#666",marginBottom:5,fontSize:14},boxAddress:{color:"#333",marginBottom:10,fontSize:14},directionsButton:{backgroundColor:"#000",padding:10,borderRadius:5,alignSelf:"flex-start"},directionsText:{color:"#fff",fontWeight:"bold"},locationInfo:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},locationText:{color:"#666",fontSize:14},refreshButton:{backgroundColor:"#f0f0f0",padding:8,borderRadius:5},refreshText:{color:"#000",fontSize:12,fontWeight:"bold"},errorText:{color:"red",padding:10},loadingText:{marginTop:10,color:"#666"},noBoxesText:{color:"#666",fontStyle:"italic",textAlign:"center",marginTop:20}});var M=o(1815),_=o(2660);const V=(0,y.getFirestore)(),F=(0,r.createContext)(),G=({children:e})=>{const[t,o]=(0,r.useState)(null),[n,a]=(0,r.useState)(!1),[l,i]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{const e=(0,p.onAuthStateChanged)(C,(async e=>{try{if(e){const t=(0,y.doc)(V,"users",e.uid),n=await(0,y.getDoc)(t);a(n.exists()&&n.data().profileCreated),o(Object.assign({uid:e.uid,email:e.email},n.exists()?n.data():{}))}else o(null),a(!1)}catch(t){console.error("Error in auth state change:",t)}finally{i(!1)}}));return()=>e()}),[]),(0,w.jsx)(F.Provider,{value:{user:t,profileComplete:n,loading:l},children:e})},$=h.default.create({container:{flex:1,backgroundColor:"#fff"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},loadingText:{marginTop:16,color:"#8E8E93"},errorText:{fontSize:18,color:"#FF3B30",marginVertical:16,textAlign:"center",paddingHorizontal:24},retryButton:{backgroundColor:"#007AFF",paddingHorizontal:24,paddingVertical:12,borderRadius:8,marginTop:16},retryButtonText:{color:"#fff",fontSize:16,fontWeight:"500"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,borderBottomWidth:h.default.hairlineWidth,borderBottomColor:"#C6C6C8"},headerTitle:{fontSize:34,fontWeight:"bold"},searchContainer:{flexDirection:"row",alignItems:"center",backgroundColor:"#F2F2F7",borderRadius:10,marginHorizontal:16,marginVertical:8,paddingHorizontal:12,paddingVertical:8},searchIcon:{marginRight:8},searchInput:{flex:1,fontSize:17,color:"#000",paddingVertical:0},chatItem:{flexDirection:"row",alignItems:"center",paddingHorizontal:16,paddingVertical:12,borderBottomWidth:h.default.hairlineWidth,borderBottomColor:"#C6C6C8"},avatar:{width:56,height:56,borderRadius:28,marginRight:12},avatarPlaceholder:{width:56,height:56,borderRadius:28,backgroundColor:"#E1E1E6",justifyContent:"center",alignItems:"center",marginRight:12},avatarText:{fontSize:24,fontWeight:"500",color:"#8E8E93"},chatContent:{flex:1},chatName:{fontSize:17,fontWeight:"500",marginBottom:2},eventName:{fontSize:15,color:"#8E8E93",marginBottom:2},lastMessage:{fontSize:16,color:"#00000099"},time:{fontSize:15,color:"#8E8E93"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyText:{fontSize:20,fontWeight:"500",color:"#8E8E93",marginTop:16},emptySubtext:{fontSize:16,color:"#8E8E93",marginTop:8,textAlign:"center"}}),q=({route:e})=>{const[t,o]=(0,r.useState)([]),[n,s]=(0,r.useState)(!0),[d,h]=(0,r.useState)(null),[x,p]=(0,r.useState)(!1),[j,b]=(0,r.useState)(""),[C,S]=(0,r.useState)({}),{user:z}=(0,r.useContext)(F),B=(0,i.useNavigation)(),I=e=>e.sort().join("_");(0,r.useEffect)((()=>{const e=(0,y.collection)(T,"users"),t=(0,y.onSnapshot)(e,(e=>{const t={};e.forEach((e=>{t[e.id]=e.data()})),S(t)}));return()=>t()}),[]);const E=(0,r.useCallback)((()=>{let e=()=>{};try{if(!z?.uid)return s(!1),h("User not authenticated"),e;s(!0),h(null);const t=(0,y.query)((0,y.collection)(T,"chats"),(0,y.where)("participants","array-contains",z.uid));e=(0,y.onSnapshot)(t,(e=>{const t=new Map;e.docs.forEach((e=>{const o=e.data(),n=o.participants||[],r=n.find((e=>e!==z.uid)),a=o.chatKey||I(n),l=t.get(a),i=o.lastMessageAt?.toDate()||new Date(0);(!l||i>l.lastMessageAt)&&t.set(a,{id:e.id,lastMessage:o.lastMessage||"No messages yet",lastMessageAt:i,otherUserId:r,otherUserName:C[r]?.name||o.participantInfo?.[r]?.name||("organizer"===z.role?"Attendee":"Organizer"),otherUserPhoto:C[r]?.photoURL||o.participantInfo?.[r]?.photoURL||null,eventName:o.eventName||"Unknown Event",participants:n,chatKey:a})}));const n=Array.from(t.values()).sort(((e,t)=>t.lastMessageAt-e.lastMessageAt));o(n),s(!1),p(!1)}),(e=>{console.error("Firestore error:",e),h("Failed to load chats"),s(!1),p(!1)}))}catch(d){console.error("Error setting up listener:",d),h("Failed to initialize chat service"),s(!1),p(!1)}return e}),[z,C]);(0,i.useFocusEffect)((0,r.useCallback)((()=>{const e=E();return()=>e()}),[E]));const D=t.filter((e=>{if(!j)return!0;const t=j.toLowerCase();return e.otherUserName.toLowerCase().includes(t)||e.eventName.toLowerCase().includes(t)||e.lastMessage.toLowerCase().includes(t)}));return n&&!x?(0,w.jsxs)(l.default,{style:$.centered,children:[(0,w.jsx)(a.default,{size:"large"}),(0,w.jsx)(u.default,{style:$.loadingText,children:"Loading your chats..."})]}):d?(0,w.jsxs)(l.default,{style:$.centered,children:[(0,w.jsx)(c.default,{name:"warning",size:48,color:"#FF3B30"}),(0,w.jsx)(u.default,{style:$.errorText,children:d}),(0,w.jsx)(g.default,{style:$.retryButton,onPress:()=>{h(null),s(!0),E()},children:(0,w.jsx)(u.default,{style:$.retryButtonText,children:"Try Again"})})]}):(0,w.jsxs)(k.default,{style:$.container,children:[(0,w.jsx)(M.default,{barStyle:"dark-content"}),(0,w.jsx)(l.default,{style:$.header}),(0,w.jsxs)(l.default,{style:$.searchContainer,children:[(0,w.jsx)(c.default,{name:"search",size:20,color:"#8E8E93",style:$.searchIcon}),(0,w.jsx)(R.default,{style:$.searchInput,placeholder:"Search chats...",placeholderTextColor:"#8E8E93",value:j,onChangeText:b})]}),(0,w.jsx)(f.default,{data:D,keyExtractor:e=>e.id,renderItem:({item:e})=>(0,w.jsxs)(g.default,{style:$.chatItem,onPress:()=>{return t=e,void(z?.uid&&t?.id?B.navigate("ChatScreen",{chatId:t.id,otherUserId:t.otherUserId,otherUserName:C[t.otherUserId]?.name||t.otherUserName,eventName:t.eventName,isOrganizer:"organizer"===z.role}):m.default.alert("Error","Cannot open chat at this time"));var t},children:[e.otherUserPhoto?(0,w.jsx)(v.default,{source:{uri:e.otherUserPhoto},style:$.avatar}):(0,w.jsx)(l.default,{style:$.avatarPlaceholder,children:(0,w.jsx)(u.default,{style:$.avatarText,children:e.otherUserName.charAt(0).toUpperCase()})}),(0,w.jsxs)(l.default,{style:$.chatContent,children:[(0,w.jsx)(u.default,{style:$.chatName,children:e.otherUserName}),(0,w.jsx)(u.default,{style:$.eventName,children:e.eventName}),(0,w.jsx)(u.default,{style:$.lastMessage,children:e.lastMessage})]}),(0,w.jsx)(u.default,{style:$.time,children:e.lastMessageAt.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),ListEmptyComponent:(0,w.jsxs)(l.default,{style:$.emptyContainer,children:[(0,w.jsx)(c.default,{name:"chatbubbles-outline",size:64,color:"#C7C7CC"}),(0,w.jsx)(u.default,{style:$.emptyText,children:"No conversations found"}),(0,w.jsx)(u.default,{style:$.emptySubtext,children:j?"Try a different search":"Start a new chat to get started"})]}),refreshControl:(0,w.jsx)(_.default,{refreshing:x,onRefresh:()=>{p(!0),E()}})})]})};var K=o(5708),Y=o(4767);const X=h.default.create({container:{flex:1,backgroundColor:"#fff"},header:{flexDirection:"row",alignItems:"center",padding:16,borderBottomWidth:1,borderBottomColor:"#f0f0f0"},headerTextContainer:{flex:1},headerTitle:{fontSize:18,fontWeight:"bold"},headerSubtitle:{fontSize:14,color:"#666",marginTop:4},messagesList:{padding:16,paddingBottom:80},messageContainer:{padding:12,marginVertical:4,borderRadius:12,maxWidth:"80%"},currentUserMessage:{alignSelf:"flex-end",backgroundColor:"#DCF8C6",borderBottomRightRadius:0},otherUserMessage:{alignSelf:"flex-start",backgroundColor:"#ECECEC",borderBottomLeftRadius:0},senderName:{fontWeight:"bold",color:"#333",fontSize:14,marginBottom:4},messageText:{fontSize:16,color:"#000"},messageTime:{fontSize:10,textAlign:"right",marginTop:4,color:"#666"},inputContainer:{flexDirection:"row",alignItems:"center",padding:10,borderTopWidth:1,borderTopColor:"#eee",backgroundColor:"#fff",position:"absolute",bottom:0,left:0,right:0},input:{flex:1,borderWidth:1,borderColor:"#ddd",borderRadius:20,paddingHorizontal:15,paddingVertical:10,marginRight:10,maxHeight:100,backgroundColor:"#f9f9f9"},sendButton:{backgroundColor:"#4CAF50",borderRadius:20,paddingVertical:10,paddingHorizontal:20},disabledButton:{backgroundColor:"#cccccc"},sendButtonText:{color:"white",fontWeight:"bold"}}),J=({route:e,navigation:t})=>{const{chatId:o,otherUserId:n,eventName:a}=e.params,[i,s]=(0,r.useState)([]),[d,c]=(0,r.useState)(""),[g,h]=(0,r.useState)({}),x=(0,r.useRef)(null);(0,r.useEffect)((()=>{const e=(0,y.collection)(T,"chats",o,"messages"),t=(0,y.query)(e,(0,y.orderBy)("createdAt","asc")),n=(0,y.onSnapshot)(t,(e=>{const t=[];e.forEach((e=>{t.push(Object.assign({id:e.id},e.data()))})),s(t),setTimeout((()=>{x.current?.scrollToEnd({animated:!0})}),100)})),r=(0,y.collection)(T,"users"),a=(0,y.onSnapshot)(r,(e=>{const t={};e.forEach((e=>{t[e.id]=e.data()})),h(t)}));return()=>{n(),a()}}),[o]);return(0,w.jsxs)(Y.default,{behavior:"height",style:X.container,keyboardVerticalOffset:90,children:[(0,w.jsx)(l.default,{style:X.header,children:(0,w.jsxs)(l.default,{style:X.headerTextContainer,children:[(0,w.jsx)(u.default,{style:X.headerTitle,children:a}),(0,w.jsxs)(u.default,{style:X.headerSubtitle,children:["Chat with ",g[n]?.name||"User"]})]})}),(0,w.jsx)(f.default,{ref:x,data:i,keyExtractor:e=>e.id,renderItem:({item:e})=>{const t=e.senderId===C.currentUser?.uid,o=(g[e.senderId]||{}).name||"Unknown",n=e.createdAt?.toDate?e.createdAt.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"...";return(0,w.jsxs)(l.default,{style:[X.messageContainer,t?X.currentUserMessage:X.otherUserMessage],children:[!t&&(0,w.jsx)(u.default,{style:X.senderName,children:o}),(0,w.jsx)(u.default,{style:X.messageText,children:e.text}),(0,w.jsx)(u.default,{style:X.messageTime,children:n})]})},contentContainerStyle:X.messagesList,onContentSizeChange:()=>x.current?.scrollToEnd({animated:!0}),onLayout:()=>x.current?.scrollToEnd({animated:!0})}),(0,w.jsxs)(l.default,{style:X.inputContainer,children:[(0,w.jsx)(R.default,{style:X.input,value:d,onChangeText:c,placeholder:"Type a message...",multiline:!0,placeholderTextColor:"#999"}),(0,w.jsx)(K.default,{style:({pressed:e})=>[X.sendButton,{opacity:e?.7:1},!d.trim()&&X.disabledButton],onPress:async()=>{if(d.trim()&&C.currentUser)try{const e=(0,y.collection)(T,"chats",o,"messages");await(0,y.addDoc)(e,{text:d,senderId:C.currentUser.uid,createdAt:(0,y.serverTimestamp)()});const t=(0,y.doc)(T,"chats",o);await(0,y.setDoc)(t,{lastMessage:d,lastMessageAt:(0,y.serverTimestamp)()},{merge:!0}),c("")}catch(e){console.error("Error sending message:",e),m.default.alert("Error","Failed to send message. Please try again.")}},disabled:!d.trim(),children:(0,w.jsx)(u.default,{style:X.sendButtonText,children:"Send"})})]})]})},Z=(0,s.createNativeStackNavigator)(),Q=()=>(0,w.jsxs)(Z.Navigator,{children:[(0,w.jsx)(Z.Screen,{name:"ChatList",component:q,options:{title:"Messages"}}),(0,w.jsx)(Z.Screen,{name:"ChatScreen",component:J,options:({route:e})=>({title:e.params?.eventName||"Chat",headerBackTitle:"Back"})})]}),ee=(0,d.createBottomTabNavigator)(),te=()=>(0,w.jsxs)(ee.Navigator,{screenOptions:({route:e})=>({tabBarIcon:({focused:t,color:o,size:n})=>{let r;return"Home"===e.name?r=t?"home":"home-outline":"Search"===e.name?r=t?"search":"search-outline":"Add"===e.name?r=t?"add-circle":"add-circle-outline":"Chats"===e.name?r=t?"chatbubble":"chatbubble-outline":"Profile"===e.name&&(r=t?"person":"person-outline"),(0,w.jsx)(c.default,{name:r,size:n,color:o})},tabBarActiveTintColor:"black",tabBarInactiveTintColor:"gray",tabBarShowLabel:!1,headerShown:!1}),children:[(0,w.jsx)(ee.Screen,{name:"Home",component:z}),(0,w.jsx)(ee.Screen,{name:"Search",component:U}),(0,w.jsx)(ee.Screen,{name:"Add",component:A}),(0,w.jsx)(ee.Screen,{name:"Chats",component:Q}),(0,w.jsx)(ee.Screen,{name:"Profile",component:E})]});function oe(){const[e,t]=(0,r.useState)([]),[o,n]=(0,r.useState)(!0),[i,s]=(0,r.useState)(null),d=async()=>{try{const e=await S.default.get("http://localhost:5000/api/user/events");t(e.data)}catch(e){console.error("Error fetching events:",e)}finally{n(!1)}};(0,r.useEffect)((()=>{d()}),[]);const c=async()=>{try{await S.default.delete(`http://localhost:5000/api/admin/events/${i._id}`,i),s(null),d()}catch(e){console.error("Error deleting Event:",e)}};return i?(0,w.jsxs)(l.default,{style:ne.container,children:[(0,w.jsx)(g.default,{onPress:()=>s(null),style:ne.backButton,children:(0,w.jsx)(u.default,{style:ne.backButtonText,children:"\u2190 Back"})}),(0,w.jsx)(u.default,{style:ne.detailTitle,children:i.name}),(0,w.jsxs)(l.default,{style:ne.detailContainer,children:[(0,w.jsx)(u.default,{style:ne.detailLabel,children:"Description"}),(0,w.jsx)(u.default,{style:ne.detailText,children:i.description}),(0,w.jsx)(u.default,{style:ne.detailLabel,children:"Location"}),(0,w.jsx)(u.default,{style:ne.detailText,children:i.location.address})]}),(0,w.jsx)(l.default,{style:ne.buttonGroup,children:(0,w.jsx)(g.default,{style:ne.deleteButton,onPress:c,children:(0,w.jsx)(u.default,{style:ne.buttonText,children:"Delete"})})})]}):(0,w.jsxs)(l.default,{style:ne.container,children:[(0,w.jsx)(u.default,{style:ne.welcomeText,children:"Event Management"}),o?(0,w.jsx)(a.default,{size:"large",color:"#000000",style:{marginTop:20}}):(0,w.jsx)(f.default,{data:e,keyExtractor:e=>e._id,renderItem:({item:e})=>(0,w.jsx)(g.default,{onPress:()=>s(e),children:(0,w.jsxs)(l.default,{style:ne.donationItem,children:[(0,w.jsx)(u.default,{style:ne.donationTitle,children:e.name}),(0,w.jsx)(u.default,{style:ne.donationText,children:e.description}),(0,w.jsxs)(u.default,{style:ne.donationText,children:["Location: ",e.location.address||""]})]})}),contentContainerStyle:ne.listContainer,ListEmptyComponent:(0,w.jsx)(u.default,{style:ne.emptyText,children:"No events found"})})]})}const ne=h.default.create({container:{flex:1,padding:20,backgroundColor:"#ffffff"},welcomeText:{fontSize:22,fontWeight:"600",marginBottom:20,color:"#000000"},listContainer:{paddingBottom:20},donationItem:{padding:15,marginVertical:8,backgroundColor:"#f8f8f8",borderRadius:8,borderWidth:1,borderColor:"#e0e0e0"},donationTitle:{fontSize:16,fontWeight:"600",marginBottom:5,color:"#000000"},donationText:{fontSize:14,color:"#333333",marginBottom:3},backButton:{marginBottom:20},backButtonText:{fontSize:18,color:"#000000"},sectionTitle:{fontSize:20,fontWeight:"600",marginBottom:20,color:"#000000"},detailTitle:{fontSize:24,fontWeight:"600",marginBottom:20,color:"#000000"},detailContainer:{marginBottom:30},detailLabel:{fontSize:16,fontWeight:"600",marginTop:15,marginBottom:5,color:"#000000"},detailText:{fontSize:16,color:"#333333"},infoContainer:{marginBottom:20},label:{fontSize:14,fontWeight:"600",marginTop:10,marginBottom:5,color:"#000000"},infoText:{fontSize:16,marginBottom:15,color:"#333333"},input:{borderWidth:1,borderColor:"#cccccc",borderRadius:5,padding:12,marginBottom:15,fontSize:16,backgroundColor:"#ffffff"},buttonGroup:{flexDirection:"row",justifyContent:"space-between",marginTop:20},editButton:{backgroundColor:"#333333",padding:15,borderRadius:5,flex:1,marginRight:10},saveButton:{backgroundColor:"#333333",padding:15,borderRadius:5},deleteButton:{backgroundColor:"#333333",padding:15,borderRadius:5,flex:1,marginLeft:10},buttonText:{color:"#ffffff",textAlign:"center",fontWeight:"600"},emptyText:{textAlign:"center",marginTop:20,fontSize:16,color:"#666666"}});function re({navigation:e}){const[t,o]=(0,r.useState)(null),[n,i]=(0,r.useState)(null),[s,d]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{(async()=>{try{d(!0);const e=await C.currentUser.getIdToken(),t=await S.default.get("http://localhost:5000/api/user/user-details",{headers:{Authorization:`Bearer ${e}`}});o(t.data)}catch(e){const t=e.response?.data?.message||e.message;m.default.alert("Error",t),i(t)}finally{d(!1)}})()}),[]),s?(0,w.jsxs)(l.default,{style:ae.loadingContainer,children:[(0,w.jsx)(a.default,{size:"large",color:"#000"}),(0,w.jsx)(u.default,{style:ae.loadingText,children:"Loading profile..."})]}):n?(0,w.jsxs)(l.default,{style:ae.errorContainer,children:[(0,w.jsx)(c.default,{name:"warning",size:40,color:"#000"}),(0,w.jsx)(u.default,{style:ae.errorText,children:n}),(0,w.jsx)(g.default,{style:ae.retryButton,onPress:()=>{i(null),d(!0),fetchProfile()},children:(0,w.jsx)(u.default,{style:ae.retryButtonText,children:"Try Again"})})]}):(0,w.jsxs)(k.default,{style:ae.container,children:[(0,w.jsxs)(I.default,{contentContainerStyle:ae.scrollContent,children:[(0,w.jsxs)(l.default,{style:ae.profileHeader,children:[(0,w.jsx)(l.default,{style:ae.profileImageContainer,children:(0,w.jsx)(c.default,{name:"person-circle-outline",size:80,color:"#000"})}),(0,w.jsx)(u.default,{style:ae.profileName,children:t?.name||"Admin"}),(0,w.jsx)(u.default,{style:ae.profileEmail,children:t?.email})]}),(0,w.jsxs)(l.default,{style:ae.section,children:[(0,w.jsx)(u.default,{style:ae.sectionTitle,children:"Account Information"}),(0,w.jsxs)(l.default,{style:ae.infoRow,children:[(0,w.jsx)(c.default,{name:"mail-outline",size:20,color:"#666"}),(0,w.jsx)(u.default,{style:ae.infoText,children:t?.email})]}),(0,w.jsxs)(l.default,{style:ae.infoRow,children:[(0,w.jsx)(c.default,{name:"person-outline",size:20,color:"#666"}),(0,w.jsx)(u.default,{style:ae.infoText,children:t?.name||"Admin User"})]})]})]}),(0,w.jsxs)(l.default,{style:ae.footer,children:[(0,w.jsxs)(g.default,{style:ae.actionButton,onPress:async()=>{try{const e=C.currentUser;if(!e)return void m.default.alert("Error","User not authenticated");await(0,p.sendPasswordResetEmail)(C,e.email),m.default.alert("Success","Password reset email sent. Please check your inbox."),setShowSettingsModal(!1)}catch(n){console.error("Error sending password reset email:",n),m.default.alert("Error","Failed to send password reset email")}},children:[(0,w.jsx)(c.default,{name:"key-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:ae.actionButtonText,children:"Reset Password"}),(0,w.jsx)(c.default,{name:"chevron-forward",size:20,color:"#666"})]}),(0,w.jsxs)(g.default,{style:ae.logoutButton,onPress:async()=>{try{await C.signOut()}catch(n){m.default.alert("Logout Error",n.message)}},children:[(0,w.jsx)(c.default,{name:"log-out-outline",size:20,color:"#fff"}),(0,w.jsx)(u.default,{style:ae.logoutText,children:"Log Out"})]})]})]})}const ae=h.default.create({container:{flex:1,backgroundColor:"#fff"},scrollContent:{padding:16,paddingBottom:100},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#fff"},loadingText:{marginTop:16,color:"#000",fontSize:16},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24,backgroundColor:"#fff"},errorText:{fontSize:16,color:"#000",marginTop:16,textAlign:"center",marginBottom:24},retryButton:{backgroundColor:"#000",paddingHorizontal:24,paddingVertical:12,borderRadius:8,flexDirection:"row",alignItems:"center"},retryButtonText:{color:"#fff",fontWeight:"600",marginLeft:8},profileHeader:{alignItems:"center",marginBottom:24,padding:20,backgroundColor:"#fff",borderRadius:12,borderWidth:1,borderColor:"#eee"},profileImageContainer:{backgroundColor:"#f5f5f5",borderRadius:40,padding:8},profileName:{fontSize:22,fontWeight:"600",marginTop:12,color:"#000",textAlign:"center"},profileEmail:{fontSize:16,color:"#666",marginTop:4,textAlign:"center"},section:{marginBottom:16,backgroundColor:"#fff",borderRadius:12,padding:20,borderWidth:1,borderColor:"#eee"},sectionTitle:{fontSize:16,fontWeight:"600",color:"#000",marginBottom:16},infoRow:{flexDirection:"row",alignItems:"center",marginBottom:12},infoText:{fontSize:16,color:"#000",marginLeft:12},actionButton:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,backgroundColor:"#fff",borderRadius:8,borderWidth:1,borderColor:"#eee",marginBottom:16},actionButtonText:{flex:1,fontSize:16,color:"#000",marginLeft:12},footer:{position:"absolute",bottom:0,left:0,right:0,padding:16,backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#eee"},logoutButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,backgroundColor:"#000",borderRadius:8},logoutText:{fontSize:16,fontWeight:"500",color:"#fff",marginLeft:8}});var le=o(8264);const ie=h.default.create({container:{flex:1,padding:20,backgroundColor:"#fff"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20,paddingBottom:10,borderBottomWidth:1,borderBottomColor:"#eee"},headerTitle:{fontSize:22,fontWeight:"600",color:"#000"},addButton:{backgroundColor:"#000",width:40,height:40,borderRadius:20,justifyContent:"center",alignItems:"center"},boxContainer:{padding:16,marginVertical:8,backgroundColor:"#f8f8f8",borderRadius:8,borderWidth:1,borderColor:"#eee"},boxName:{fontWeight:"600",fontSize:16,marginBottom:4,color:"#000"},boxAddress:{fontSize:14,color:"#555",marginBottom:4},boxType:{fontSize:14,color:"#555",fontStyle:"italic"},backButton:{flexDirection:"row",alignItems:"center",marginBottom:20},backButtonText:{marginLeft:5,fontSize:16,color:"#000"},detailCard:{backgroundColor:"#f8f8f8",borderRadius:8,padding:20,borderWidth:1,borderColor:"#eee"},detailTitle:{fontSize:22,fontWeight:"600",marginBottom:16,color:"#000",borderBottomWidth:1,borderBottomColor:"#eee",paddingBottom:10},detailRow:{flexDirection:"row",alignItems:"center",marginBottom:12},detailText:{fontSize:16,color:"#333",marginLeft:10},deleteButton:{backgroundColor:"#f8f8f8",padding:15,borderRadius:8,alignItems:"center",marginTop:20,borderWidth:1,borderColor:"#ccc"},deleteButtonText:{color:"#000",fontWeight:"600"},modalContainer:{flex:1,padding:20,backgroundColor:"#fff"},modalHeader:{flexDirection:"row",alignItems:"center",marginBottom:20,paddingBottom:15,borderBottomWidth:1,borderBottomColor:"#eee"},closeButton:{padding:5},modalTitle:{fontSize:20,fontWeight:"600",marginLeft:10,color:"#000"},input:{backgroundColor:"#f8f8f8",padding:15,borderRadius:8,marginBottom:15,fontSize:16,color:"#000",borderWidth:1,borderColor:"#eee"},submitButton:{backgroundColor:"#000",padding:16,borderRadius:8,alignItems:"center",marginTop:10},submitButtonText:{color:"#fff",fontWeight:"600",fontSize:16},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",marginTop:50},emptyText:{fontSize:16,color:"#999",marginTop:10},listContainer:{paddingBottom:20},errorText:{color:"red",fontSize:12,marginTop:-10,marginBottom:10},label:{fontSize:14,fontWeight:"500",marginBottom:8,color:"#333"},formSection:{flex:1},autocompleteWrapper:{zIndex:1e3,marginBottom:15},dropdown:{backgroundColor:"#fff",borderWidth:1,borderColor:"#ddd",borderRadius:8,marginTop:5,maxHeight:200},placeItem:{flexDirection:"row",alignItems:"center",padding:10,borderBottomWidth:1,borderBottomColor:"#eee"},placeText:{marginLeft:10,color:"#333"},placeDescription:{fontSize:14,color:"#666"},selectedLocationText:{fontSize:14,color:"#007bff",marginTop:-10,marginBottom:15}}),se=()=>{const[e,t]=(0,r.useState)([]),[o,n]=(0,r.useState)(!0),[i,s]=(0,r.useState)(null),[d,h]=(0,r.useState)(!1),[x,p]=(0,r.useState)({name:"",address:"",latitude:"",longitude:"",type:"",hours:"",phone:""}),[y,j]=(0,r.useState)({name:"",address:"",type:"",hours:""}),[b,C]=(0,r.useState)({address:"",lat:null,lng:null,placeId:null}),[T,z]=(0,r.useState)(!1),[B,I]=(0,r.useState)(!1),v=(0,r.useRef)(null),k=(0,r.useRef)(!1),E=async()=>{try{n(!0);const e=await S.default.get("http://localhost:5000/api/user/donation-boxes");t(e.data)}catch(e){console.error("Error fetching donation boxes:",e),m.default.alert("Error","Failed to fetch donation boxes")}finally{n(!1)}};(0,r.useEffect)((()=>{E()}),[]),(0,r.useEffect)((()=>{{if(window.google&&window.google.maps)return void z(!0);const e="google-maps-script";if(document.getElementById(e))return;const t=document.createElement("script");return t.id=e,t.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDSahTexUybVADs-MwPT4MNnWai_-kTr1I&libraries=places",t.async=!0,t.defer=!0,t.onload=()=>{z(!0)},t.onerror=()=>{I(!0),m.default.alert("Error","Failed to load maps functionality")},document.head.appendChild(t),()=>{document.head.contains(t)&&document.head.removeChild(t)}}}),[]),(0,r.useEffect)((()=>{if(T&&d){const e=setTimeout((()=>{D()}),500);return()=>clearTimeout(e)}}),[T,d]);const D=()=>{try{const e=document.getElementById("meeting-point-input");if(!e||k.current)return;const t={types:["geocode","establishment"],componentRestrictions:{country:"us"},fields:["formatted_address","geometry","place_id","name"]},o=new window.google.maps.places.Autocomplete(e,t);v.current=o,k.current=!0,o.addListener("place_changed",(()=>{const e=o.getPlace();if(!e.geometry)return void j((e=>Object.assign({},e,{address:"Invalid location selected"})));const t={address:e.formatted_address||e.name,lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),placeId:e.place_id};C(t),p((e=>Object.assign({},e,{address:t.address,latitude:t.lat.toString(),longitude:t.lng.toString()}))),j((e=>Object.assign({},e,{address:""})))}))}catch(e){console.error("Autocomplete initialization error:",e),I(!0)}},P=()=>{p({name:"",address:"",latitude:"",longitude:"",type:"",hours:"",phone:""}),C({address:"",lat:null,lng:null,placeId:null}),j({name:"",address:"",type:"",hours:""}),setTimeout((()=>{const e=document.getElementById("meeting-point-input");e&&(e.value="")}),100)},L=async()=>{try{await S.default.delete(`http://localhost:5000/api/admin/donation-boxes/${i._id}`),s(null),await E(),m.default.alert("Success","Donation box deleted successfully")}catch(e){console.error("Error deleting donation box:",e),m.default.alert("Error","Failed to delete donation box")}};return i?(0,w.jsxs)(l.default,{style:ie.container,children:[(0,w.jsxs)(g.default,{onPress:()=>s(null),style:ie.backButton,children:[(0,w.jsx)(c.default,{name:"arrow-back",size:24,color:"black"}),(0,w.jsx)(u.default,{style:ie.backButtonText,children:"Back"})]}),(0,w.jsxs)(l.default,{style:ie.detailCard,children:[(0,w.jsx)(u.default,{style:ie.detailTitle,children:i.name}),(0,w.jsxs)(l.default,{style:ie.detailRow,children:[(0,w.jsx)(c.default,{name:"location-outline",size:18,color:"#333"}),(0,w.jsx)(u.default,{style:ie.detailText,children:i.address})]}),(0,w.jsxs)(l.default,{style:ie.detailRow,children:[(0,w.jsx)(c.default,{name:"pricetag-outline",size:18,color:"#333"}),(0,w.jsx)(u.default,{style:ie.detailText,children:i.type})]}),(0,w.jsxs)(l.default,{style:ie.detailRow,children:[(0,w.jsx)(c.default,{name:"time-outline",size:18,color:"#333"}),(0,w.jsx)(u.default,{style:ie.detailText,children:i.hours})]}),i.phone&&(0,w.jsxs)(l.default,{style:ie.detailRow,children:[(0,w.jsx)(c.default,{name:"call-outline",size:18,color:"#333"}),(0,w.jsx)(u.default,{style:ie.detailText,children:i.phone})]}),(0,w.jsx)(g.default,{style:ie.deleteButton,onPress:L,children:(0,w.jsx)(u.default,{style:ie.deleteButtonText,children:"Delete Donation Box"})})]})]}):(0,w.jsxs)(l.default,{style:ie.container,children:[(0,w.jsxs)(l.default,{style:ie.header,children:[(0,w.jsx)(u.default,{style:ie.headerTitle,children:"Donation Boxes"}),(0,w.jsx)(g.default,{style:ie.addButton,onPress:()=>h(!0),children:(0,w.jsx)(c.default,{name:"add",size:24,color:"white"})})]}),o?(0,w.jsx)(a.default,{size:"large",color:"#333",style:{marginTop:20}}):0===e.length?(0,w.jsxs)(l.default,{style:ie.emptyContainer,children:[(0,w.jsx)(c.default,{name:"archive-outline",size:50,color:"#999"}),(0,w.jsx)(u.default,{style:ie.emptyText,children:"No donation boxes found"})]}):(0,w.jsx)(f.default,{data:e,keyExtractor:e=>e._id,renderItem:({item:e})=>(0,w.jsx)(g.default,{onPress:()=>s(e),children:(0,w.jsxs)(l.default,{style:ie.boxContainer,children:[(0,w.jsx)(u.default,{style:ie.boxName,children:e.name}),(0,w.jsx)(u.default,{style:ie.boxAddress,children:e.address}),(0,w.jsx)(u.default,{style:ie.boxType,children:e.type})]})}),contentContainerStyle:ie.listContainer}),(0,w.jsx)(le.default,{visible:d,animationType:"slide",children:(0,w.jsxs)(l.default,{style:ie.modalContainer,children:[(0,w.jsxs)(l.default,{style:ie.modalHeader,children:[(0,w.jsx)(g.default,{style:ie.closeButton,onPress:()=>{h(!1),P()},children:(0,w.jsx)(c.default,{name:"close",size:24,color:"black"})}),(0,w.jsx)(u.default,{style:ie.modalTitle,children:"Add New Donation Box"})]}),(0,w.jsxs)(l.default,{style:ie.formSection,children:[(0,w.jsx)(u.default,{style:ie.label,children:"Name *"}),(0,w.jsx)(R.default,{style:ie.input,placeholder:"Enter donation box name",placeholderTextColor:"#999",value:x.name,onChangeText:e=>p(Object.assign({},x,{name:e}))}),y.name?(0,w.jsx)(u.default,{style:ie.errorText,children:y.name}):null,(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(u.default,{style:ie.label,children:["Location * ",B&&"(Maps functionality unavailable)"]}),(0,w.jsx)("input",{id:"meeting-point-input",type:"text",placeholder:"Search location",disabled:B,style:{width:"100%",padding:"15px",borderRadius:"8px",border:"1px solid #eee",marginBottom:"15px",backgroundColor:B?"#f1f1f1":"#f8f8f8"}}),b.address&&(0,w.jsxs)(u.default,{style:ie.selectedLocationText,children:["Selected: ",b.address]}),y.address?(0,w.jsx)(u.default,{style:ie.errorText,children:y.address}):null]}),(0,w.jsx)(u.default,{style:ie.label,children:"Type *"}),(0,w.jsx)(R.default,{style:ie.input,placeholder:"e.g., Clothing, Electronics",placeholderTextColor:"#999",value:x.type,onChangeText:e=>p(Object.assign({},x,{type:e}))}),y.type?(0,w.jsx)(u.default,{style:ie.errorText,children:y.type}):null,(0,w.jsx)(u.default,{style:ie.label,children:"Hours *"}),(0,w.jsx)(R.default,{style:ie.input,placeholder:"e.g., Mon-Sat 9am - 8pm",placeholderTextColor:"#999",value:x.hours,onChangeText:e=>p(Object.assign({},x,{hours:e}))}),y.hours?(0,w.jsx)(u.default,{style:ie.errorText,children:y.hours}):null,(0,w.jsx)(u.default,{style:ie.label,children:"Phone"}),(0,w.jsx)(R.default,{style:ie.input,placeholder:"e.g., +1 123-456-7890",placeholderTextColor:"#999",keyboardType:"phone-pad",value:x.phone,onChangeText:e=>p(Object.assign({},x,{phone:e}))})]}),(0,w.jsx)(g.default,{style:ie.submitButton,onPress:async()=>{if((()=>{let e=!0;const t={name:"",address:"",type:"",hours:""};return x.name.trim()||(t.name="Name is required",e=!1),(b.address||x.address)&&(b.lat||x.latitude)&&(b.lng||x.longitude)||(t.address="Valid location is required",e=!1),x.type.trim()||(t.type="Type is required",e=!1),x.hours.trim()||(t.hours="Hours are required",e=!1),j(t),e})())try{const o=b.lat||parseFloat(x.latitude),n=b.lng||parseFloat(x.longitude),r=b.address||x.address;if(!o||!n||!r)return void j((e=>Object.assign({},e,{address:"Valid location coordinates required"})));const a=Object.assign({},x,{address:r,latitude:o,longitude:n}),l=await S.default.post("http://localhost:5000/api/admin/donation-boxes",a);t([...e,l.data]),h(!1),P(),m.default.alert("Success","Donation box added successfully")}catch(o){console.error("Error adding donation box:",o),m.default.alert("Error",o.response?.data?.message||"Failed to add donation box")}},children:(0,w.jsx)(u.default,{style:ie.submitButtonText,children:"Add Donation Box"})})]})})]})};var de=o(9149);function ce(){const[e,t]=(0,r.useState)([]),[o,n]=(0,r.useState)(!0),[i,s]=(0,r.useState)(null),[d,c]=(0,r.useState)(!1),[m,h]=(0,r.useState)({}),[x,p]=(0,r.useState)(!1),y=async()=>{try{const e=await S.default.get("http://localhost:5000/api/user/donations");t(e.data)}catch(e){console.error("Error fetching donations:",e)}finally{n(!1)}};(0,r.useEffect)((()=>{y()}),[]);const j=async()=>{try{await S.default.delete(`http://localhost:5000/api/admin/donations/${i._id}`,i),s(null),c(!1),p(!1),y()}catch(e){console.error("Error deleting donation:",e)}},b=async()=>{try{await S.default.put(`http://localhost:5000/api/admin/donations/${i._id}`,m),s(null),c(!1),y()}catch(e){console.error("Error updating donation:",e)}};return i?d?(0,w.jsxs)(l.default,{style:ue.container,children:[(0,w.jsxs)(g.default,{onPress:()=>c(!1),style:ue.backButton,children:[(0,w.jsx)(de.default,{name:"arrow-back",size:24,color:"#000"}),(0,w.jsx)(u.default,{style:ue.backButtonText,children:"Back"})]}),(0,w.jsx)(u.default,{style:ue.sectionTitle,children:"Edit Donation Details"}),(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Name"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.name})]}),(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Description"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.description})]}),(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Address"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.address.address})]}),(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Donor Availability"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.availability})]}),(0,w.jsxs)(l.default,{style:ue.inputContainer,children:[(0,w.jsx)(u.default,{style:ue.inputLabel,children:"Assignee"}),(0,w.jsx)(R.default,{placeholder:"Enter assignee name",value:m.assignee,onChangeText:e=>h(Object.assign({},m,{assignee:e})),style:ue.input})]}),(0,w.jsxs)(l.default,{style:ue.inputContainer,children:[(0,w.jsx)(u.default,{style:ue.inputLabel,children:"Pickup Date & Time"}),(0,w.jsx)(R.default,{placeholder:"Enter date and time",value:m.dateTime,onChangeText:e=>h(Object.assign({},m,{dateTime:e})),style:ue.input})]}),(0,w.jsx)(l.default,{style:ue.buttonGroup,children:(0,w.jsx)(g.default,{onPress:b,style:[ue.button,ue.saveButton],children:(0,w.jsx)(u.default,{style:ue.buttonText,children:"Save Changes"})})})]}):(0,w.jsxs)(l.default,{style:ue.container,children:[(0,w.jsxs)(g.default,{onPress:()=>s(null),style:ue.backButton,children:[(0,w.jsx)(de.default,{name:"arrow-back",size:24,color:"#000"}),(0,w.jsx)(u.default,{style:ue.backButtonText,children:"Back"})]}),(0,w.jsx)(u.default,{style:ue.detailTitle,children:i.name}),(0,w.jsxs)(l.default,{style:ue.detailCard,children:[(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Description"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.description})]}),(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Location"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.address.address})]}),(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Donor Availability"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.availability})]}),(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Assignee"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.assignee||"Unassigned"})]}),i.dateTime&&(0,w.jsxs)(l.default,{style:ue.detailRow,children:[(0,w.jsx)(u.default,{style:ue.detailLabel,children:"Pickup Date & Time"}),(0,w.jsx)(u.default,{style:ue.detailValue,children:i.dateTime})]})]}),(0,w.jsxs)(l.default,{style:ue.buttonGroup,children:[(0,w.jsxs)(g.default,{onPress:()=>{c(!0),h({assignee:i.assignee||"",dateTime:i.dateTime||""})},style:[ue.button,ue.editButton],children:[(0,w.jsx)(de.default,{name:"edit",size:18,color:"#fff"}),(0,w.jsx)(u.default,{style:[ue.buttonText,{marginLeft:8}],children:"Edit"})]}),(0,w.jsxs)(g.default,{onPress:()=>p(!0),style:[ue.button,ue.deleteButton],children:[(0,w.jsx)(de.default,{name:"delete",size:18,color:"#fff"}),(0,w.jsx)(u.default,{style:[ue.buttonText,{marginLeft:8}],children:"Delete"})]})]}),(0,w.jsx)(le.default,{animationType:"fade",transparent:!0,visible:x,onRequestClose:()=>p(!1),children:(0,w.jsx)(l.default,{style:ue.modalOverlay,children:(0,w.jsxs)(l.default,{style:ue.modalContent,children:[(0,w.jsx)(u.default,{style:ue.modalTitle,children:"Confirm Deletion"}),(0,w.jsx)(u.default,{style:ue.modalText,children:"Are you sure you want to delete this donation? This action cannot be undone."}),(0,w.jsxs)(l.default,{style:ue.modalButtons,children:[(0,w.jsx)(g.default,{onPress:()=>p(!1),style:[ue.modalButton,ue.cancelButton],children:(0,w.jsx)(u.default,{style:ue.modalButtonText,children:"Cancel"})}),(0,w.jsx)(g.default,{onPress:j,style:[ue.modalButton,ue.confirmDeleteButton],children:(0,w.jsx)(u.default,{style:ue.modalButtonText,children:"Delete"})})]})]})})})]}):(0,w.jsxs)(l.default,{style:ue.container,children:[(0,w.jsx)(u.default,{style:ue.welcomeTitle,children:"Pickup Request Management"}),o?(0,w.jsxs)(l.default,{style:ue.loadingContainer,children:[(0,w.jsx)(a.default,{size:"large",color:"#333"}),(0,w.jsx)(u.default,{style:ue.loadingText,children:"Loading donations..."})]}):(0,w.jsx)(f.default,{data:e,keyExtractor:e=>e._id,renderItem:({item:e})=>(0,w.jsxs)(g.default,{onPress:()=>s(e),style:ue.donationItem,children:[(0,w.jsxs)(l.default,{style:ue.donationContent,children:[(0,w.jsx)(u.default,{style:ue.donationTitle,children:e.name}),(0,w.jsx)(u.default,{style:ue.donationDescription,children:e.description}),(0,w.jsxs)(l.default,{style:ue.donationMeta,children:[(0,w.jsx)(de.default,{name:"location-on",size:16,color:"#555"}),(0,w.jsx)(u.default,{style:ue.donationMetaText,children:e.address.address||"Location not specified"})]}),(0,w.jsxs)(l.default,{style:ue.donationMeta,children:[(0,w.jsx)(de.default,{name:"person",size:16,color:"#555"}),(0,w.jsx)(u.default,{style:ue.donationMetaText,children:e.assignee||"Unassigned"})]}),e.dateTime&&(0,w.jsxs)(l.default,{style:ue.donationMeta,children:[(0,w.jsx)(de.default,{name:"schedule",size:16,color:"#555"}),(0,w.jsx)(u.default,{style:ue.donationMetaText,children:e.dateTime})]})]}),(0,w.jsx)(de.default,{name:"chevron-right",size:24,color:"#555"})]}),contentContainerStyle:ue.listContent,ListEmptyComponent:(0,w.jsxs)(l.default,{style:ue.emptyState,children:[(0,w.jsx)(de.default,{name:"inbox",size:48,color:"#999"}),(0,w.jsx)(u.default,{style:ue.emptyStateText,children:"No donations found"})]})})]})}const ue=h.default.create({container:{flex:1,padding:20,backgroundColor:"#fff"},welcomeTitle:{fontSize:24,fontWeight:"600",marginBottom:20,color:"#000"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,color:"#555"},listContent:{paddingBottom:20},donationItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:16,marginBottom:12,backgroundColor:"#fff",borderRadius:8,borderWidth:1,borderColor:"#eee",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},donationContent:{flex:1},donationTitle:{fontSize:16,fontWeight:"600",marginBottom:4,color:"#000"},donationDescription:{fontSize:14,marginBottom:8,color:"#555"},donationMeta:{flexDirection:"row",alignItems:"center",marginBottom:4},donationMetaText:{fontSize:13,marginLeft:6,color:"#555"},backButton:{flexDirection:"row",alignItems:"center",marginBottom:20},backButtonText:{fontSize:18,marginLeft:8,color:"#000"},sectionTitle:{fontSize:20,fontWeight:"600",marginBottom:20,color:"#000"},detailTitle:{fontSize:22,fontWeight:"600",marginBottom:16,color:"#000"},detailCard:{backgroundColor:"#fff",borderRadius:8,padding:16,marginBottom:20,borderWidth:1,borderColor:"#eee",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},detailRow:{marginBottom:12},detailLabel:{fontSize:14,fontWeight:"600",color:"#333",marginBottom:4},detailValue:{fontSize:16,color:"#555"},inputContainer:{marginBottom:16},inputLabel:{fontSize:14,fontWeight:"600",marginBottom:8,color:"#333"},input:{borderWidth:1,borderColor:"#ddd",borderRadius:6,padding:12,fontSize:16,backgroundColor:"#fff"},buttonGroup:{flexDirection:"row",justifyContent:"space-between",marginTop:20},button:{flexDirection:"row",justifyContent:"center",alignItems:"center",paddingVertical:12,paddingHorizontal:20,borderRadius:6,flex:1},editButton:{backgroundColor:"#333",marginRight:10},deleteButton:{backgroundColor:"#d32f2f",marginLeft:10},saveButton:{backgroundColor:"#333"},buttonText:{color:"#fff",fontSize:16,fontWeight:"500"},emptyState:{flex:1,justifyContent:"center",alignItems:"center",padding:40},emptyStateText:{marginTop:16,fontSize:16,color:"#999"},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.5)"},modalContent:{width:"80%",backgroundColor:"#fff",borderRadius:8,padding:20},modalTitle:{fontSize:18,fontWeight:"600",marginBottom:10,color:"#000"},modalText:{fontSize:16,marginBottom:20,color:"#555"},modalButtons:{flexDirection:"row",justifyContent:"flex-end"},modalButton:{paddingVertical:10,paddingHorizontal:20,borderRadius:6,marginLeft:10},cancelButton:{backgroundColor:"#999"},confirmDeleteButton:{backgroundColor:"#d32f2f"},modalButtonText:{color:"#fff",fontSize:16,fontWeight:"500"}}),fe=(0,d.createBottomTabNavigator)(),ge=()=>(0,w.jsxs)(fe.Navigator,{screenOptions:({route:e})=>({tabBarIcon:({focused:t,color:o,size:n})=>{let r;return"ManageEvents"===e.name?r=t?"calendar":"calendar-outline":"ManageDonations"===e.name?r=t?"people":"people-outline":"ManageBoxes"===e.name?r=t?"cube":"cube-outline":"Chat"===e.name?r=t?"chatbubble":"chatbubble-outline":"AdminProfile"===e.name&&(r=t?"person":"person-outline"),(0,w.jsx)(c.default,{name:r,size:n,color:o})},tabBarActiveTintColor:"black",tabBarInactiveTintColor:"gray",tabBarShowLabel:!1,headerShown:!1}),children:[(0,w.jsx)(fe.Screen,{name:"ManageEvents",component:oe}),(0,w.jsx)(fe.Screen,{name:"ManageBoxes",component:se}),(0,w.jsx)(fe.Screen,{name:"ManageDonations",component:ce}),(0,w.jsx)(fe.Screen,{name:"Chat",component:Q}),(0,w.jsx)(fe.Screen,{name:"AdminProfile",component:re})]}),me=h.default.create({container:{flex:1,backgroundColor:"#fff"},scrollContent:{padding:16,paddingBottom:100},detailScrollContent:{padding:16},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#fff"},loadingText:{marginTop:16,color:"#000",fontSize:16},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:24,backgroundColor:"#fff"},errorText:{fontSize:16,color:"#000",marginTop:16,textAlign:"center",marginBottom:24},retryButton:{backgroundColor:"#000",paddingHorizontal:24,paddingVertical:12,borderRadius:8,flexDirection:"row",alignItems:"center"},retryButtonText:{color:"#fff",fontWeight:"600",marginLeft:8},profileHeader:{alignItems:"center",marginBottom:24,padding:20,backgroundColor:"#fff",borderRadius:12,borderWidth:1,borderColor:"#eee"},profileImageContainer:{backgroundColor:"#f5f5f5",borderRadius:40,padding:8},profileName:{fontSize:22,fontWeight:"600",marginTop:12,color:"#000",textAlign:"center"},profileEmail:{fontSize:16,color:"#666",marginTop:4,textAlign:"center"},section:{marginBottom:16,backgroundColor:"#fff",borderRadius:12,padding:20,borderWidth:1,borderColor:"#eee"},sectionHeader:{flexDirection:"row",alignItems:"center",marginBottom:16},sectionTitle:{fontSize:18,fontWeight:"600",color:"#000",marginLeft:8},eventCard:{backgroundColor:"#fff",borderRadius:8,padding:16,marginBottom:12,borderWidth:1,borderColor:"#eee"},eventHeader:{flexDirection:"row",alignItems:"center",marginBottom:8},eventTitle:{fontSize:16,fontWeight:"600",color:"#000",marginLeft:8},eventDescription:{fontSize:14,color:"#333",marginBottom:8,lineHeight:20},eventDateContainer:{flexDirection:"row",alignItems:"center",marginTop:4},eventDate:{fontSize:12,color:"#666",marginLeft:4},eventLocationContainer:{flexDirection:"row",alignItems:"center",marginTop:4},eventLocation:{fontSize:12,color:"#666",marginLeft:4,flex:1},listContent:{paddingBottom:8},emptyState:{alignItems:"center",padding:24},emptyText:{fontSize:16,color:"#999",marginTop:16},footer:{position:"absolute",bottom:0,left:0,right:0,padding:16,backgroundColor:"#fff",borderTopWidth:1,borderTopColor:"#eee"},contactAdminButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,backgroundColor:"#000",borderRadius:8,marginBottom:12},contactAdminText:{fontSize:16,fontWeight:"500",color:"#fff",marginLeft:8},actionButton:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:16,backgroundColor:"#fff",borderRadius:8,borderWidth:1,borderColor:"#eee",marginBottom:16},actionButtonText:{flex:1,fontSize:16,color:"#000",marginLeft:12},logoutButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,backgroundColor:"#333",borderRadius:8},logoutText:{fontSize:16,fontWeight:"500",color:"#fff",marginLeft:8},detailContainer:{flex:1,backgroundColor:"#fff"},detailContent:{paddingBottom:100},backButton:{flexDirection:"row",alignItems:"center",padding:16,paddingBottom:8},backButtonText:{fontSize:16,color:"#000",marginLeft:8,fontWeight:"500"},detailTitle:{fontSize:24,fontWeight:"700",color:"#000",marginBottom:24,marginTop:8,paddingHorizontal:16},detailSection:{marginBottom:24,backgroundColor:"#fff",borderRadius:8,padding:20,borderWidth:1,borderColor:"#eee",marginHorizontal:16},sectionLabel:{fontSize:13,fontWeight:"700",color:"#666",marginBottom:12,textTransform:"uppercase",letterSpacing:1},sectionText:{fontSize:16,color:"#000",lineHeight:24},infoRow:{flexDirection:"row",alignItems:"center",marginTop:8},infoIcon:{marginRight:8},itemsContainer:{flexDirection:"row",flexWrap:"wrap",marginTop:8},itemTag:{backgroundColor:"#f5f5f5",borderRadius:4,paddingHorizontal:12,paddingVertical:6,marginRight:8,marginBottom:8,borderWidth:1,borderColor:"#eee"},itemText:{fontSize:14,color:"#000"},contactButton:{flexDirection:"row",alignItems:"center",justifyContent:"center",padding:16,backgroundColor:"#000",borderRadius:8,marginTop:16,marginBottom:24,marginHorizontal:16},contactButtonText:{fontSize:16,fontWeight:"500",color:"#fff",marginLeft:8}}),he=({navigation:e})=>{const[t,o]=(0,r.useState)(null),[n,i]=(0,r.useState)([]),[s,d]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),[j,b]=(0,r.useState)(!0),z="VlNgmUErG7QjqCC5hhLkPoyDb0P2",B=async()=>{try{if(!C.currentUser)return void m.default.alert("Error","You must be logged in to contact admin");const t=await v(z,"Admin",s?s._id:null,s?`Event: ${s.name||"Untitled"}`:"General Inquiry");e.navigate("Chat",{screen:"ChatScreen",params:{chatId:t.chatId,otherUserId:z,otherUserName:"Admin",eventName:t.eventName}})}catch(h){console.error("Error contacting admin:",h),m.default.alert("Error","Failed to open chat with admin. Please try again later.")}},v=async(e,t,o,n)=>{try{const r=C.currentUser;if(!r)throw new Error("User not authenticated");const a=await(async e=>{try{const t=C.currentUser;if(!t)return null;const o=(0,y.collection)(T,"chats"),n=[t.uid,e].sort().join("_"),r=await(0,y.getDocs)((0,y.query)(o,(0,y.where)("chatKey","==",n)));if(!r.empty){const e=r.docs[0];return Object.assign({id:e.id},e.data())}return null}catch(h){return console.error("Error checking for existing admin chat:",h),null}})(e);if(a)return{chatId:a.id,otherUserId:e,otherUserName:a.participantInfo?.[e]?.name||t,eventName:n||a.eventName||"Admin Chat"};const l=[r.uid,e].sort().join("_"),i={participants:[r.uid,e],participantInfo:{[r.uid]:{name:r.displayName||"Organizer",photoURL:r.photoURL||null},[e]:{name:t,photoURL:null}},eventId:o,eventName:n||"Admin Chat",lastMessage:"",lastMessageAt:(0,y.serverTimestamp)(),createdAt:(0,y.serverTimestamp)(),chatKey:l},s=(0,y.doc)((0,y.collection)(T,"chats"));await(0,y.setDoc)(s,i);const d=(0,y.collection)(T,"chats",s.id,"messages");return await(0,y.addDoc)(d,{text:o?`Hello! I need help with my event (${n}).`:"Hello! I need some assistance.",senderId:r.uid,senderName:r.displayName||"Organizer",createdAt:(0,y.serverTimestamp)()}),await(0,y.setDoc)(s,{lastMessage:o?`Hello! I need help with my event (${n}).`:"Hello! I need some assistance.",lastMessageAt:(0,y.serverTimestamp)()},{merge:!0}),{chatId:s.id,otherUserId:e,otherUserName:t,eventName:n||"Admin Chat"}}catch(h){throw console.error("Error in getOrCreateAdminChat:",h),h}};if((0,r.useEffect)((()=>{(async()=>{try{b(!0);const e=C.currentUser;if(!e)throw new Error("User not authenticated");const t=await e.getIdToken(),n=await S.default.get("http://localhost:5000/api/user/user-details",{headers:{Authorization:`Bearer ${t}`}}),r=(await S.default.get("http://localhost:5000/api/user/events",{headers:{Authorization:`Bearer ${t}`}})).data.filter((t=>t.organizer_id===e.uid));i(r),o(n.data)}catch(e){const t=e.response?.data?.message||e.message;m.default.alert("Error",t),x(t)}finally{b(!1)}})()}),[]),j)return(0,w.jsxs)(l.default,{style:me.loadingContainer,children:[(0,w.jsx)(a.default,{size:"large",color:"#000"}),(0,w.jsx)(u.default,{style:me.loadingText,children:"Loading profile..."})]});if(h)return(0,w.jsxs)(l.default,{style:me.errorContainer,children:[(0,w.jsx)(c.default,{name:"warning",size:40,color:"#000"}),(0,w.jsx)(u.default,{style:me.errorText,children:h}),(0,w.jsx)(g.default,{style:me.retryButton,onPress:()=>{x(null),b(!0)},children:(0,w.jsx)(u.default,{style:me.retryButtonText,children:"Try Again"})})]});return s?(0,w.jsxs)(k.default,{style:me.detailContainer,children:[(0,w.jsxs)(g.default,{onPress:()=>d(null),style:me.backButton,children:[(0,w.jsx)(c.default,{name:"arrow-back",size:24,color:"#000"}),(0,w.jsx)(u.default,{style:me.backButtonText,children:"Back to Events"})]}),(0,w.jsx)(I.default,{showsVerticalScrollIndicator:!1,contentContainerStyle:me.detailScrollContent,children:(0,w.jsxs)(l.default,{style:me.detailContent,children:[(0,w.jsx)(u.default,{style:me.detailTitle,children:s.name||"Event"}),(0,w.jsxs)(l.default,{style:me.detailSection,children:[(0,w.jsx)(u.default,{style:me.sectionLabel,children:"DESCRIPTION"}),(0,w.jsx)(u.default,{style:me.sectionText,children:s.description||"No description provided"})]}),(0,w.jsxs)(l.default,{style:me.detailSection,children:[(0,w.jsx)(u.default,{style:me.sectionLabel,children:"DATE"}),(0,w.jsxs)(l.default,{style:me.infoRow,children:[(0,w.jsx)(c.default,{name:"calendar-outline",size:16,color:"#666",style:me.infoIcon}),(0,w.jsx)(u.default,{style:me.sectionText,children:new Date(s.date).toLocaleDateString()})]})]}),s.location?.address&&(0,w.jsxs)(l.default,{style:me.detailSection,children:[(0,w.jsx)(u.default,{style:me.sectionLabel,children:"LOCATION"}),(0,w.jsxs)(l.default,{style:me.infoRow,children:[(0,w.jsx)(c.default,{name:"location-outline",size:16,color:"#666",style:me.infoIcon}),(0,w.jsx)(u.default,{style:me.sectionText,children:s.location.address})]})]}),s.items_accepted?.length>0&&(0,w.jsxs)(l.default,{style:me.detailSection,children:[(0,w.jsx)(u.default,{style:me.sectionLabel,children:"ITEMS ACCEPTED"}),(0,w.jsx)(l.default,{style:me.itemsContainer,children:s.items_accepted.map(((e,t)=>(0,w.jsx)(l.default,{style:me.itemTag,children:(0,w.jsx)(u.default,{style:me.itemText,children:e})},t)))})]}),(0,w.jsxs)(g.default,{style:me.contactButton,onPress:B,children:[(0,w.jsx)(c.default,{name:"chatbubble-outline",size:20,color:"#fff"}),(0,w.jsx)(u.default,{style:me.contactButtonText,children:"Contact Admin About This Event"})]})]})})]}):(0,w.jsxs)(k.default,{style:me.container,children:[(0,w.jsxs)(I.default,{showsVerticalScrollIndicator:!1,contentContainerStyle:me.scrollContent,children:[(0,w.jsxs)(l.default,{style:me.profileHeader,children:[(0,w.jsx)(l.default,{style:me.profileImageContainer,children:(0,w.jsx)(c.default,{name:"person-circle-outline",size:80,color:"#000"})}),(0,w.jsx)(u.default,{style:me.profileName,children:t?.name||"Organizer"}),(0,w.jsx)(u.default,{style:me.profileEmail,children:t?.email})]}),(0,w.jsxs)(l.default,{style:me.section,children:[(0,w.jsxs)(l.default,{style:me.sectionHeader,children:[(0,w.jsx)(c.default,{name:"calendar-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:me.sectionTitle,children:"Your Events"})]}),0===n.length?(0,w.jsxs)(l.default,{style:me.emptyState,children:[(0,w.jsx)(c.default,{name:"calendar-outline",size:40,color:"#999"}),(0,w.jsx)(u.default,{style:me.emptyText,children:"No events posted yet"})]}):(0,w.jsx)(f.default,{data:n,keyExtractor:e=>e._id,renderItem:({item:e})=>(0,w.jsxs)(g.default,{onPress:()=>d(e),style:me.eventCard,children:[(0,w.jsxs)(l.default,{style:me.eventHeader,children:[(0,w.jsx)(c.default,{name:"calendar-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:me.eventTitle,children:e.name||"Untitled Event"})]}),e.description&&(0,w.jsx)(u.default,{style:me.eventDescription,numberOfLines:2,children:e.description}),e.date&&(0,w.jsxs)(l.default,{style:me.eventDateContainer,children:[(0,w.jsx)(c.default,{name:"time",size:14,color:"#666"}),(0,w.jsx)(u.default,{style:me.eventDate,children:new Date(e.date).toLocaleDateString()})]}),e.location?.address&&(0,w.jsxs)(l.default,{style:me.eventLocationContainer,children:[(0,w.jsx)(c.default,{name:"location-outline",size:14,color:"#666"}),(0,w.jsx)(u.default,{style:me.eventLocation,numberOfLines:1,children:e.location.address})]})]}),contentContainerStyle:me.listContent,scrollEnabled:!1})]})]}),(0,w.jsxs)(l.default,{style:me.footer,children:[(0,w.jsxs)(g.default,{style:me.actionButton,onPress:async()=>{try{const e=C.currentUser;if(!e)return void m.default.alert("Error","User not authenticated");await(0,p.sendPasswordResetEmail)(C,e.email),m.default.alert("Success","Password reset email sent. Please check your inbox.")}catch(h){console.error("Error sending password reset email:",h),m.default.alert("Error","Failed to send password reset email")}},children:[(0,w.jsx)(c.default,{name:"key-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:me.actionButtonText,children:"Reset Password"}),(0,w.jsx)(c.default,{name:"chevron-forward",size:20,color:"#666"})]}),(0,w.jsxs)(g.default,{style:me.actionButton,onPress:B,children:[(0,w.jsx)(c.default,{name:"headset-outline",size:20,color:"#000"}),(0,w.jsx)(u.default,{style:me.actionButtonText,children:"Contact Admin"}),(0,w.jsx)(c.default,{name:"chevron-forward",size:20,color:"#666"})]}),(0,w.jsxs)(g.default,{style:me.logoutButton,onPress:async()=>{await C.signOut()},children:[(0,w.jsx)(c.default,{name:"log-out-outline",size:20,color:"#fff"}),(0,w.jsx)(u.default,{style:me.logoutText,children:"Log Out"})]})]})]})};var xe=o(4505);o(9162);const pe=["Clothes","Toys","Books","Groceries","Electronics"],ye=h.default.create({container:{flexGrow:1,padding:24,backgroundColor:"#fff"},screenTitle:{fontSize:24,fontWeight:"700",color:"#000",marginBottom:24,textAlign:"center"},inputGroup:{marginBottom:24},label:{fontSize:13,fontWeight:"600",color:"#666",marginBottom:8,textTransform:"uppercase",letterSpacing:.8},input:{borderWidth:1,borderColor:"#ddd",borderRadius:8,paddingHorizontal:16,paddingVertical:12,fontSize:16,color:"#000",backgroundColor:"#fff"},multilineInput:{minHeight:100,textAlignVertical:"top"},autocompleteWrapper:{borderWidth:1,borderColor:"#ddd",borderRadius:8,overflow:"hidden"},dropdown:{backgroundColor:"#fff",borderWidth:1,borderColor:"#ddd",marginTop:4},placeDescription:{color:"#000"},dateInputWrapper:{borderWidth:1,borderColor:"#ddd",borderRadius:8,padding:16},dateInput:{paddingVertical:12},dateText:{fontSize:16,color:"#000"},webDateInput:{width:"100%",padding:12,border:"1px solid #ddd",borderRadius:8,fontSize:16},checkboxGroup:{flexDirection:"row",flexWrap:"wrap"},checkboxContainer:{flexDirection:"row",alignItems:"center",marginRight:24,marginBottom:12,paddingVertical:8},checkboxLabel:{fontSize:16,color:"#000",marginLeft:8},submitButton:{backgroundColor:"#000",borderRadius:8,padding:16,alignItems:"center",marginTop:16},submitButtonText:{color:"#fff",fontSize:16,fontWeight:"600"},loadingText:{color:"#666",fontSize:14,marginTop:8},errorText:{color:"#ff0000",fontSize:12,marginTop:4}}),je=()=>{const[e,t]=(0,r.useState)({name:"",description:"",items_accepted:[]}),[o,n]=(0,r.useState)({address:"",lat:null,lng:null,placeId:null}),[i,s]=(0,r.useState)(new Date),[d,c]=(0,r.useState)(!1),[f,h]=(0,r.useState)(!1),[x,j]=(0,r.useState)(!1),[b,T]=(0,r.useState)("");(0,r.useRef)(null);(0,r.useEffect)((()=>{{const e=()=>{const e=document.getElementById("meeting-point-input");if(e&&window.google?.maps?.places){const t=new window.google.maps.places.Autocomplete(e,{types:["geocode","establishment"],componentRestrictions:{country:"us"},fields:["formatted_address","geometry","place_id"]});t.addListener("place_changed",(()=>{const e=t.getPlace();e.geometry?z(null,{formatted_address:e.formatted_address,geometry:{location:e.geometry.location},place_id:e.place_id}):T("Please select a valid location from dropdown")}))}};if(window.google?.maps)return h(!0),void e();const t="google-maps-script";if(document.getElementById(t))return;const o=document.createElement("script");o.id=t,o.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDw26V3Tw0g6tXKWX5ruHx8nAl6eJrn7vI&libraries=places",o.async=!0,o.defer=!0,o.onload=()=>{h(!0),e()},o.onerror=()=>{m.default.alert("Error","Failed to load maps functionality")},document.head.appendChild(o)}}),[]);const z=(e,t=null)=>{try{if(!t)return void T("Please select a valid location from dropdown");const o=t.formatted_address||e?.description,r=t.geometry?.location?.lat?.()||t.geometry?.location?.lat,a=t.geometry?.location?.lng?.()||t.geometry?.location?.lng,l=t.place_id;if(!o||!r||!a)return void T("Invalid location selected");n({address:o,lat:r,lng:a,placeId:l}),T("")}catch(o){console.error("Location selection error:",o),T("Please select a valid location")}},B=(e,o)=>{t((t=>Object.assign({},t,{[e]:o})))};return(0,w.jsxs)(I.default,{contentContainerStyle:ye.container,children:[(0,w.jsx)(u.default,{style:ye.screenTitle,children:"Create Donation Event"}),(0,w.jsxs)(l.default,{style:ye.inputGroup,children:[(0,w.jsx)(u.default,{style:ye.label,children:"EVENT NAME *"}),(0,w.jsx)(R.default,{style:ye.input,placeholder:"Enter event name",placeholderTextColor:"#999",value:e.name,onChangeText:e=>B("name",e)})]}),(0,w.jsxs)(l.default,{style:ye.inputGroup,children:[(0,w.jsx)(u.default,{style:ye.label,children:"DESCRIPTION *"}),(0,w.jsx)(R.default,{style:[ye.input,ye.multilineInput],placeholder:"Describe your donation event",placeholderTextColor:"#999",multiline:!0,numberOfLines:4,value:e.description,onChangeText:e=>B("description",e)})]}),(0,w.jsxs)(l.default,{style:ye.inputGroup,children:[(0,w.jsx)(u.default,{style:ye.label,children:"LOCATION *"}),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(R.default,{id:"meeting-point-input",style:ye.input,placeholder:"Search for a location",placeholderTextColor:"#999",value:o.address,onChangeText:e=>{n((t=>Object.assign({},t,{address:e}))),e&&!o.lat&&T("Please select from dropdown")}}),!f&&(0,w.jsx)(u.default,{style:ye.loadingText,children:"Loading maps..."}),b?(0,w.jsx)(u.default,{style:ye.errorText,children:b}):null]})]}),(0,w.jsx)(l.default,{style:ye.inputGroup,children:(0,w.jsx)((({label:e})=>(0,w.jsxs)(l.default,{style:ye.dateInputWrapper,children:[(0,w.jsx)(u.default,{style:ye.label,children:e}),(0,w.jsx)("input",{type:"date",value:i.toISOString().split("T")[0],onChange:e=>s(new Date(e.target.value)),min:(new Date).toISOString().split("T")[0],style:ye.webDateInput})]})),{label:"EVENT DATE *"})}),(0,w.jsxs)(l.default,{style:ye.inputGroup,children:[(0,w.jsx)(u.default,{style:ye.label,children:"ITEMS ACCEPTED *"}),(0,w.jsx)(l.default,{style:ye.checkboxGroup,children:pe.map((o=>(0,w.jsxs)(l.default,{style:ye.checkboxContainer,children:[(0,w.jsx)(xe.default,{value:e.items_accepted.includes(o),onValueChange:()=>(e=>{t((t=>Object.assign({},t,{items_accepted:t.items_accepted.includes(e)?t.items_accepted.filter((t=>t!==e)):[...t.items_accepted,e]})))})(o),color:e.items_accepted.includes(o)?"#000":void 0}),(0,w.jsx)(u.default,{style:ye.checkboxLabel,children:o})]},o)))})]}),(0,w.jsx)(g.default,{style:ye.submitButton,onPress:async()=>{try{if(j(!0),T(""),!e.name.trim())throw new Error("Event name is required");if(!e.description.trim())throw new Error("Description is required");if(!o.lat||!o.lng)throw new Error("Please select a valid location");if(0===e.items_accepted.length)throw new Error("Please select at least one accepted item");const r=C.currentUser;if(!r)throw new Error("You must be logged in");const a={token:await(0,p.getIdToken)(r),name:e.name,description:e.description,location:{address:o.address,coordinates:new y.GeoPoint(o.lat,o.lng),placeId:o.placeId},date:i.toISOString(),items_accepted:e.items_accepted};if(201!==(await S.default.post("http://localhost:5000/api/user/events",a)).status)throw new Error("Failed to add event");m.default.alert("Success","Event added successfully!"),t({name:"",description:"",items_accepted:[]}),n({address:"",lat:null,lng:null,placeId:null}),s(new Date)}catch(r){console.error("Submission error:",r),m.default.alert("Error",r.message),r.message.includes("location")&&T(r.message)}finally{j(!1)}},disabled:x,children:x?(0,w.jsx)(a.default,{color:"#fff"}):(0,w.jsx)(u.default,{style:ye.submitButtonText,children:"CREATE EVENT"})})]})},be=(0,d.createBottomTabNavigator)(),Ce=()=>(0,w.jsxs)(be.Navigator,{screenOptions:({route:e})=>({tabBarIcon:({focused:t,color:o,size:n})=>{let r;return"Add"===e.name?r=t?"add-circle":"add-circle-outline":"Chat"===e.name?r=t?"chatbubble":"chatbubble-outline":"Profile"===e.name&&(r=t?"person":"person-outline"),(0,w.jsx)(c.default,{name:r,size:n,color:o})},tabBarActiveTintColor:"black",tabBarInactiveTintColor:"gray",tabBarShowLabel:!1,headerShown:!1}),children:[(0,w.jsx)(be.Screen,{name:"Add",component:je}),(0,w.jsx)(be.Screen,{name:"Chat",component:Q}),(0,w.jsx)(be.Screen,{name:"Profile",component:he})]});var Te=o(2349);function Se({navigation:e}){const[t,o]=(0,r.useState)(""),[n,a]=(0,r.useState)(""),[i,s]=(0,r.useState)(!1);return(0,w.jsxs)(l.default,{style:we.container,children:[(0,w.jsxs)(l.default,{style:we.header,children:[(0,w.jsx)(de.default,{name:"hand-heart",size:50,color:"#000",style:we.logoIcon}),(0,w.jsx)(u.default,{style:we.appName,children:"DonateIt"})]}),(0,w.jsxs)(l.default,{style:we.inputWrapper,children:[(0,w.jsx)(u.default,{style:we.inputLabel,children:"Email Address"}),(0,w.jsxs)(l.default,{style:we.inputContainer,children:[(0,w.jsx)(de.default,{name:"email-outline",size:20,color:"#555",style:we.inputIcon}),(0,w.jsx)(R.default,{placeholder:"Enter your email",placeholderTextColor:"#999",onChangeText:o,value:t,autoCapitalize:"none",keyboardType:"email-address",style:we.input})]})]}),(0,w.jsxs)(l.default,{style:we.inputWrapper,children:[(0,w.jsx)(u.default,{style:we.inputLabel,children:"Password"}),(0,w.jsxs)(l.default,{style:we.inputContainer,children:[(0,w.jsx)(de.default,{name:"lock-outline",size:20,color:"#555",style:we.inputIcon}),(0,w.jsx)(R.default,{placeholder:"Enter your password",placeholderTextColor:"#999",secureTextEntry:!i,onChangeText:a,value:n,style:we.input}),(0,w.jsx)(g.default,{onPress:()=>s(!i),style:we.passwordToggle,children:(0,w.jsx)(de.default,{name:i?"eye-off-outline":"eye-outline",size:20,color:"#555"})})]})]}),(0,w.jsx)(g.default,{style:we.signInButton,onPress:async()=>{try{const e=await(0,p.signInWithEmailAndPassword)(C,t,n);console.log("Firebase sign-in success:",e);const o=await e.user.getIdToken(!0);console.log("idToken",o)}catch(e){console.log("Firebase sign-in error:",e.code,e.message),"auth/wrong-password"===e.code?m.default.alert("Sign In Failed","Incorrect password"):"auth/user-not-found"===e.code?m.default.alert("Sign In Failed","No user found with this email"):m.default.alert("Sign In Failed","An error occurred. Please try again later")}},children:(0,w.jsx)(u.default,{style:we.buttonText,children:"Sign In"})}),(0,w.jsx)(g.default,{style:we.forgotPassword,onPress:()=>e.navigate("ForgotPassword"),children:(0,w.jsx)(u.default,{style:we.linkText,children:"Forgot Password?"})}),(0,w.jsxs)(l.default,{style:we.footer,children:[(0,w.jsx)(u.default,{style:we.footerText,children:"Don't have an account? "}),(0,w.jsx)(g.default,{onPress:()=>e.navigate("SignUp"),children:(0,w.jsx)(u.default,{style:[we.linkText,we.createAccountText],children:"Create Account"})})]})]})}const we=h.default.create({container:{flex:1,justifyContent:"center",paddingHorizontal:30,backgroundColor:"#fff"},header:{alignItems:"center",marginBottom:40},logoIcon:{marginBottom:15},appName:{fontSize:28,fontWeight:"700",color:"#000"},inputWrapper:{marginBottom:20},inputLabel:{fontSize:14,fontWeight:"500",color:"#333",marginBottom:8,marginLeft:5},inputContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:"#ddd",borderRadius:10,paddingHorizontal:15,height:50},inputIcon:{marginRight:10},input:{flex:1,height:"100%",color:"#000",fontSize:16},passwordToggle:{padding:10},signInButton:{backgroundColor:"#000",padding:16,borderRadius:10,alignItems:"center",marginTop:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:2},buttonText:{color:"#fff",fontSize:16,fontWeight:"600"},forgotPassword:{alignSelf:"flex-end",marginTop:15},footer:{flexDirection:"row",justifyContent:"center",marginTop:20},footerText:{color:"#555",fontSize:14},linkText:{color:"#000",fontWeight:"600",fontSize:14},createAccountText:{textDecorationLine:"underline"}});function ze({navigation:e}){const[t,o]=(0,r.useState)(""),[n,i]=(0,r.useState)(""),[s,d]=(0,r.useState)(""),[c,f]=(0,r.useState)(!1),[h,x]=(0,r.useState)(!1);return(0,w.jsx)(Y.default,{behavior:void 0,style:{flex:1,backgroundColor:"#fff"},children:(0,w.jsxs)(I.default,{contentContainerStyle:Be.container,children:[(0,w.jsxs)(l.default,{style:Be.header,children:[(0,w.jsx)(de.default,{name:"hand-heart",size:50,color:"#000",style:Be.logoIcon}),(0,w.jsx)(u.default,{style:Be.appName,children:"DonateIt"})]}),(0,w.jsxs)(l.default,{style:Be.inputWrapper,children:[(0,w.jsx)(u.default,{style:Be.inputLabel,children:"Full Name"}),(0,w.jsxs)(l.default,{style:Be.inputContainer,children:[(0,w.jsx)(de.default,{name:"account-outline",size:20,color:"#555",style:Be.inputIcon}),(0,w.jsx)(R.default,{placeholder:"Enter your full name",placeholderTextColor:"#999",onChangeText:i,value:n,style:Be.input})]})]}),(0,w.jsxs)(l.default,{style:Be.inputWrapper,children:[(0,w.jsx)(u.default,{style:Be.inputLabel,children:"Email Address"}),(0,w.jsxs)(l.default,{style:Be.inputContainer,children:[(0,w.jsx)(de.default,{name:"email-outline",size:20,color:"#555",style:Be.inputIcon}),(0,w.jsx)(R.default,{placeholder:"Enter your email",placeholderTextColor:"#999",onChangeText:o,value:t,keyboardType:"email-address",autoCapitalize:"none",style:Be.input})]})]}),(0,w.jsxs)(l.default,{style:Be.inputWrapper,children:[(0,w.jsx)(u.default,{style:Be.inputLabel,children:"Password"}),(0,w.jsxs)(l.default,{style:Be.inputContainer,children:[(0,w.jsx)(de.default,{name:"lock-outline",size:20,color:"#555",style:Be.inputIcon}),(0,w.jsx)(R.default,{placeholder:"Enter your password",placeholderTextColor:"#999",secureTextEntry:!c,onChangeText:d,value:s,style:Be.input}),(0,w.jsx)(g.default,{onPress:()=>f(!c),style:Be.passwordToggle,children:(0,w.jsx)(de.default,{name:c?"eye-off-outline":"eye-outline",size:20,color:"#555"})})]})]}),(0,w.jsx)(g.default,{style:Be.signUpButton,onPress:async()=>{if(t.trim()&&n.trim()&&s.trim()){x(!0);try{const o=(await(0,p.createUserWithEmailAndPassword)(C,t,s)).user,r=await o.getIdToken();await S.default.post("http://localhost:5000/api/auth/signup",{token:r,name:n}),await(0,y.setDoc)((0,y.doc)(T,"users",o.uid),{uid:o.uid,email:o.email,name:n,createdAt:(new Date).toISOString()}),m.default.alert("Success","Account created. Please sign in."),e.reset({index:0,routes:[{name:"SignIn"}]})}catch(o){console.error("Signup error:",o),m.default.alert("Error",o.message||"Signup failed")}finally{x(!1)}}else m.default.alert("Validation Error","Please fill in all required fields.")},disabled:h,children:h?(0,w.jsx)(a.default,{color:"#fff"}):(0,w.jsx)(u.default,{style:Be.buttonText,children:"Create Account"})}),(0,w.jsxs)(l.default,{style:Be.footer,children:[(0,w.jsx)(u.default,{style:Be.footerText,children:"Already have an account? "}),(0,w.jsx)(g.default,{onPress:()=>e.navigate("SignIn"),children:(0,w.jsx)(u.default,{style:[Be.linkText,Be.signInLink],children:"Sign In"})})]})]})})}const Be=h.default.create({container:{paddingHorizontal:30,paddingTop:60,paddingBottom:30},header:{alignItems:"center",marginBottom:40},logoIcon:{marginBottom:15},appName:{fontSize:28,fontWeight:"700",color:"#000"},inputWrapper:{marginBottom:20},inputLabel:{fontSize:14,fontWeight:"500",color:"#333",marginBottom:8,marginLeft:5},inputContainer:{flexDirection:"row",alignItems:"center",borderWidth:1,borderColor:"#ddd",borderRadius:10,paddingHorizontal:15,height:50},inputIcon:{marginRight:10},input:{flex:1,height:"100%",color:"#000",fontSize:16},passwordToggle:{padding:10},signUpButton:{backgroundColor:"#000",padding:16,borderRadius:10,alignItems:"center",marginTop:10,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:2},buttonText:{color:"#fff",fontSize:16,fontWeight:"600"},footer:{flexDirection:"row",justifyContent:"center",marginTop:20},footerText:{color:"#555",fontSize:14},linkText:{color:"#000",fontWeight:"600",fontSize:14},signInLink:{textDecorationLine:"underline"}});function Ie({navigation:e}){const[t,o]=(0,r.useState)("");return(0,w.jsxs)(l.default,{style:ve.container,children:[(0,w.jsx)(de.default,{name:"lock-reset",size:50,color:"#000",style:ve.icon}),(0,w.jsx)(u.default,{style:ve.title,children:"Reset Your Password"}),(0,w.jsx)(u.default,{style:ve.subtitle,children:"Enter your email to receive a password reset link."}),(0,w.jsx)(R.default,{style:ve.input,placeholder:"Enter your email",placeholderTextColor:"#999",keyboardType:"email-address",autoCapitalize:"none",onChangeText:o,value:t}),(0,w.jsx)(g.default,{style:ve.resetButton,onPress:async()=>{if(t)try{await(0,p.sendPasswordResetEmail)(C,t),m.default.alert("Success","Password reset email sent. Check your inbox."),e.goBack()}catch(o){console.log("Password reset error:",o.code,o.message),"auth/user-not-found"===o.code?m.default.alert("Error","No user found with this email."):m.default.alert("Error","Something went wrong. Please try again.")}else m.default.alert("Error","Please enter your email address.")},children:(0,w.jsx)(u.default,{style:ve.resetButtonText,children:"Send Reset Link"})})]})}const ve=h.default.create({container:{flex:1,justifyContent:"center",paddingHorizontal:30,backgroundColor:"#fff"},icon:{alignSelf:"center",marginBottom:20},title:{fontSize:22,fontWeight:"700",color:"#000",textAlign:"center",marginBottom:10},subtitle:{fontSize:14,color:"#555",textAlign:"center",marginBottom:30},input:{borderWidth:1,borderColor:"#ddd",borderRadius:10,padding:15,fontSize:16,color:"#000",marginBottom:20},resetButton:{backgroundColor:"#000",padding:16,borderRadius:10,alignItems:"center"},resetButtonText:{color:"#fff",fontSize:16,fontWeight:"600"}}),ke=(0,Te.createStackNavigator)(),Ee=()=>(0,w.jsxs)(ke.Navigator,{initialRouteName:"SignIn",screenOptions:{headerShown:!1},children:[(0,w.jsx)(ke.Screen,{name:"SignIn",component:Se}),(0,w.jsx)(ke.Screen,{name:"SignUp",component:ze}),(0,w.jsx)(ke.Screen,{name:"ForgotPassword",component:Ie})]}),De=(0,s.createNativeStackNavigator)();(0,n.default)((function(){const[e,t]=(0,r.useState)(!0),[o,n]=(0,r.useState)(null),[s,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!0),[f,g]=(0,r.useState)(!0),[m,h]=(0,r.useState)(!1),[x,y]=(0,r.useState)(!1),j=(0,p.getAuth)();return(0,r.useEffect)((()=>(0,p.onAuthStateChanged)(j,(async e=>{if(g(!1),e){n(e),h(!0);try{const t=await fetch(`http://localhost:5000/api/auth/user-role/${e.uid}`),o=await t.json();d(o.role)}catch(t){console.log("Error fetching user role:",t),d(null)}finally{h(!1)}}else n(null),d(null)}))),[]),f||o&&m?(0,w.jsx)(l.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,w.jsx)(a.default,{size:"large",color:"#0000ff"})}):(0,w.jsx)(G,{children:(0,w.jsx)(i.NavigationContainer,{children:(0,w.jsx)(De.Navigator,{screenOptions:{headerShown:!1},children:o?"admin"===s?(0,w.jsx)(De.Screen,{name:"Admin",component:ge}):"organizer"===s?(0,w.jsx)(De.Screen,{name:"Organizer",component:Ce}):(0,w.jsx)(De.Screen,{name:"User",component:te}):(0,w.jsx)(De.Screen,{name:"Auth",component:Ee})})})})}))}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}o.m=e,(()=>{var e=[];o.O=(t,n,r,a)=>{if(!n){var l=1/0;for(c=0;c<e.length;c++){for(var[n,r,a]=e[c],i=!0,s=0;s<n.length;s++)(!1&a||l>=a)&&Object.keys(o.O).every((e=>o.O[e](n[s])))?n.splice(s--,1):(i=!1,a<l&&(l=a));if(i){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]}})(),o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="/DonateIt/",(()=>{var e={792:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[l,i,s]=n,d=0;if(l.some((t=>0!==e[t]))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(s)var c=s(o)}for(t&&t(n);d<l.length;d++)a=l[d],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=o.O(void 0,[621],(()=>o(3044)));n=o.O(n)})();
//# sourceMappingURL=main.6a7f2e41.js.map